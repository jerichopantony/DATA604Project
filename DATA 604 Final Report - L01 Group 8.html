<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head></head><body>















    




    
    
    
    


<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1><center> DATA 604 PROJECT REPORT:</center></h1>
<h1><center> Crafting a Balanced Brew: The Intersection of Alcohol, Well-being, and Governmental Oversight</center></h1>
<h3><center> (L01-8) - <em>Olatomi Adigun, Gigi Chung, James Oblea, Jericho Pantony, Michaela Reyes</em></center></h3>
<h3><center> December 8, 2023</center></h3>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1><center> Introduction </center><a rel="noopener" class="anchor-link" href="#-Introduction-">&#182;</a></h1><div style="text-align: justify;">

Alcohol consumption is a prevalent and global phenomenon, with three out of four Canadians engaging in it (Statistics Canada, 2023). The international alcohol industry, valued at over $1.2 trillion in 2019, underscores the significance of this subject on a global scale (Statistia, n.d.). Our project&#39;s focus is to delve into the intricate relationship between alcohol consumption and a country&#39;s well-being.

What makes this research compelling is the multi-faceted impact of alcohol on various aspects of a nation, including its economy, society, individual well-being, and government policies. To evaluate a country&#39;s well-being, we have chosen the Sustainable Society Index as our guiding framework (see Appendix A). This index offers a comprehensive structure to assess a nation&#39;s sustainability based on economic, environmental, and human well-being factors (Sustainable Society Index, n.d.). For the purpose of our research, we will focus on human and economic factors based on the following key questions:

</div><ol>
<li>Is there any relationship between alcohol consumption and the well-being of a country based on<ul>
<li>human factors?</li>
<li>economic factors?</li>
</ul>
</li>
<li>Do government restrictions play a factor into a country’s alcohol consumption level?</li>
</ol>
<p>By addressing these questions, our project seeks to contribute valuable insights into the complex interplay between alcohol consumption and a nation&#39;s overall well-being.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1><center> Datasets </center><a rel="noopener" class="anchor-link" href="#-Datasets-">&#182;</a></h1><div style="text-align: justify;">
The relationship between national alcohol consumption and the different dimensions of a nation’s well-being will be explored using six datasets and files (Table 1). As will be detailed later, all datasets can be combined through country and year, however they only share data for 2019.

</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>Table 1: Description of Datasets<a rel="noopener" class="anchor-link" href="#Table-1:-Description-of-Datasets">&#182;</a></h3><table>
<thead><tr>
<th>Dataset Name</th>
<th>Features of Interest</th>
<th>Rows x Columns</th>
<th>Format</th>
<th>Source</th>
<th>License</th>
<th>Responsible Team Member</th>
</tr>
</thead>
<tbody>
<tr>
<td>Alcohol, Levels of Consumption</td>
<td>Aggregate alcohol Consumption (per capita in litres), Country</td>
<td>47790 x 34</td>
<td>Tabular, CSV</td>
<td>World Health Organization</td>
<td>Open Access (CC BY-NC-SA 3.0 IGO)</td>
<td>N/A</td>
</tr>
<tr>
<td>Life expectancy and Healthy life expectancy</td>
<td>Life expectancy at birth (year), Country</td>
<td>734 x 14</td>
<td>Tabular, CSV</td>
<td>World Health Organization</td>
<td>Open Access (CC BY-NC-SA 3.0 IGO)</td>
<td>Tomi Adigun</td>
</tr>
<tr>
<td>Suicide mortality rate (per 100 000 population)</td>
<td>Suicide Rate per 100 000, Country</td>
<td>17680 x 14</td>
<td>Tabular, CSV</td>
<td>World Health Organization</td>
<td>Open Access (CC BY-NC-SA 3.0 IGO)</td>
<td>Michaela Reyes</td>
</tr>
<tr>
<td>Restrictions on alcohol use in public places</td>
<td>Restrictions on alcohol use in public places, Country</td>
<td>197 x 9</td>
<td>Tabular, CSV</td>
<td>World Health Organization</td>
<td>Open Access (CC BY-NC-SA 3.0 IGO)</td>
<td>Jericho Pantony</td>
</tr>
<tr>
<td>World Economic Outlook database</td>
<td>Gross domestic product, Unemployment Rate, Inflation, Country</td>
<td>8776 x 57</td>
<td>Tabular, CSV</td>
<td>International Monetary Fund</td>
<td>Open Access (IMF Copyright and Usage)</td>
<td>Gigi Chung</td>
</tr>
<tr>
<td>World Happiness Report</td>
<td>Overall happiness Score, Country</td>
<td>157 x 9</td>
<td>Tabular, CSV</td>
<td>Kaggle</td>
<td>Open Access (CC0: Public Domain)</td>
<td>James Oblea</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>Importing Required Package<a rel="noopener" class="anchor-link" href="#Importing-Required-Package">&#182;</a></h2>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">sqlalchemy</span> <span class="k">as</span> <span class="nn">sq</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">text</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">linregress</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span> 
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">cv2</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">)</span>


<span class="c1"># I&#39;ll remember to add more here once everyone&#39;s code is attached</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>Connecting to MySQL Database, Reading and Loading Data<a rel="noopener" class="anchor-link" href="#Connecting-to-MySQL-Database,-Reading-and-Loading-Data">&#182;</a></h2>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Connecting to Database</span>

<span class="n">mysqlconnector</span> <span class="o">=</span> <span class="s1">&#39;mysql+mysqlconnector://l01-8:i7JPmMPrNS7Lf@datasciencedb2.ucalgary.ca/l01-8&#39;</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="n">mysqlconnector</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span>    
<span class="c1"># Reading CSV into pd</span>

<span class="c1"># alcohol_consumption_csv = pd.read_csv(&quot;Alcohol.csv&quot;)</span>
<span class="c1"># economic_indicators_csv = pd.read_csv(&quot;Economic Indicators.csv&quot;)</span>
<span class="c1"># happiness_scores_csv = pd.read_csv(&quot;Happiness Scores.csv&quot;)</span>
<span class="c1"># life_expectancy_csv = pd.read_csv(&quot;Life Expectancy.csv&quot;)</span>
<span class="c1">#     #Clean life_expectancy dataframe</span>
<span class="c1"># life_expectancy_csv.columns= [&quot;country&quot;, &quot;year&quot;, &quot;le_birth_both&quot;, &quot;le_birth_male&quot;, &quot;le_birth_female&quot;,</span>
<span class="c1">#                       &quot;le_age60_both&quot;, &quot;le_age60_male&quot;, &quot;le_age60_female&quot;,</span>
<span class="c1">#                       &quot;hale_birth_both&quot;, &quot;hale_birth_male&quot;, &quot;hale_birth_female&quot;,</span>
<span class="c1">#                       &quot;hale_age60_both&quot;, &quot;hale_age60_male&quot;, &quot;hale_age60_female&quot;]      #Change column names for coinciseness  #Line1</span>
<span class="c1"># life_expectancy_csv.drop(0, inplace=True)  # Drop column names in actual data  #Line2</span>
<span class="c1"># country_dict= { &quot;C&#195;&#180;te d&#39;Ivoire&quot; : &#39;C&#244;te d’Ivoire&#39;, &#39;T&#195;&#188;rkiye&#39;:&#39;T&#252;rkiye&#39;, &#39;North Macedonia&#39; : &#39;The former Yugoslav Republic of Macedonia&#39;} #Dictionary for Country Standardization to Alcohol Consumption Data</span>
<span class="c1"># life_expectancy_csv[&quot;country&quot;].replace(country_dict, inplace=True)   # Standardize country column in Life Expectancy to Location column in Alcohol Consumption</span>

<span class="c1"># public_restrictions_csv = pd.read_csv(&quot;alcohol_restrictions.csv&quot;)</span>
<span class="c1"># suicide_rates_csv = pd.read_csv(&quot;Suicide Rates.csv&quot;)</span>
<span class="c1"># Importing Dataframe into SQL</span>

<span class="c1"># chunk_size = 1000</span>
<span class="c1"># for i in range(0, len(alcohol_consumption_csv), chunk_size):</span>
<span class="c1">#     alcohol_consumption_csv.iloc[i:i+chunk_size].to_sql(&#39;alcohol_consumption&#39;, engine, if_exists=&#39;append&#39;, index=False)</span>

<span class="c1"># alcohol_consumption_csv.to_sql(&#39;alcohol_consumption&#39;, engine)</span>
<span class="c1"># economic_indicators_csv.to_sql(&#39;economic_indicators&#39;, engine)</span>
<span class="c1"># happiness_scores_csv.to_sql(&#39;happiness_scores&#39;, engine)</span>
<span class="c1"># life_expectancy_csv.to_sql(&#39;life_expectancy&#39;, engine)</span>
<span class="c1"># public_restrictions_csv.to_sql(&#39;public_restrictions&#39;, engine, if_exists=&#39;replace&#39;)</span>
<span class="c1"># suicide_rates_csv.to_sql(&#39;suicide_rates&#39;, engine)</span>

<span class="c1"># Reading SQL table back into pd Dataframe</span>

<span class="c1"># alcohol_consumption_df = pd.read_sql_table(&#39;alcohol_consumption&#39;, engine)</span>
<span class="c1"># economic_indicators_df = pd.read_sql_table(&#39;economic_indicators&#39;, engine)</span>
<span class="c1"># happiness_scores_df = pd.read_sql_table(&#39;happiness_scores&#39;, engine)</span>
<span class="c1"># life_expectancy_df = pd.read_sql_table(&#39;life_expectancy&#39;, engine)</span>
<span class="c1"># public_restrictions_df = pd.read_sql_table(&#39;public_restrictions&#39;, engine)</span>
<span class="c1"># suicide_rates_df = pd.read_sql_table(&#39;suicide_rates&#39;, engine)</span>

<span class="c1"># Double Check</span>

<span class="c1"># alcohol_consumption_df.head()</span>
<span class="c1"># economic_indicators_df.head()</span>
<span class="c1"># happiness_scores_df.head()</span>
<span class="c1"># life_expectancy_df.head()</span>
<span class="c1"># public_restrictions_df.head()</span>
<span class="c1"># suicide_rates_df.head()</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1><center> Data Cleaning &amp; Preprocessing </center></h1>
<div style="text-align: justify;">

To begin our data analysis process, in our respective SQL queries, we will filter our datasets to exclusively include data from the year 2019 as it is the most recent and comprehensive year across all our datasets except for the one pertaining to public restrictions on alcohol consumption. Given that it is only available for 2016, we pragmatically assume that these restrictions remain consistent in 2019. This tailored approach ensures a balance between data availability and the necessity of incorporating relevant information for a thorough analysis. The decision to only focus our analysis to 2019 is driven by a twofold consideration - firstly, the imperative to harmonize datasets for effective integration, and secondly, the practical acknowledgment of limitations, such as the unavailability of certain data for certain years. This transparency ensures a nuanced understanding of our analytical scope and forms a critical component of our project’s narrative. Overall, this not only streamlines our analysis but also ensures that we are working with the most relevant and up-to-date information, enhancing the robustness of our findings.

In our analysis, it is crucial to highlight that we filtered the `alcohol_consumption` dataset, focusing exclusively on &#39;all types&#39; of alcohol. Nevertheless, it is worth noting that the dataset contains detailed information on specific alcohol categories, including wine, beer, and others.

Following which, our attention turns to achieving uniformity in country names across our diverse datasets. We are tackling this by standardizing cases, trimming excess spaces, and ensuring a consistent representation. This standardization is pivotal for effective dataset integration, enabling seamless joins with &quot;Country&quot; as the common column for all our datasets. 

These processes will be done under our respective parts in answering the guiding questions.

</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1><center> Guiding Questions &amp; Methodology </center></h1>
<div style="text-align: justify;">

The Entity-Relationship Diagram (ERD) in Appendix B explains the primary variables of interest within the datasets and their interconnections. The datasets categorized under &quot;Well-being factors&quot; will be analyzed in conjunction with the alcohol consumption dataset to address the first guiding question. For the second guiding question, the alcohol policies dataset will be analyzed. These datasets share common variables which are &quot;country&quot; and &quot;year&quot;, facilitating the merging of datasets for analytical purposes.

</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>Guiding Question 1 - Is there any relationship between alcohol consumption and the well-being of a country based on a) human and b) economic factors?<a rel="noopener" class="anchor-link" href="#Guiding-Question-1---Is-there-any-relationship-between-alcohol-consumption-and-the-well-being-of-a-country-based-on-a)-human-and-b)-economic-factors?">&#182;</a></h2>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>Human Factors<a rel="noopener" class="anchor-link" href="#Human-Factors">&#182;</a></h3>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

The initial segment of our first guiding question is dedicated to find the correlation between a country&#39;s well-being and alcohol consumption, with a focus on key human factors: happiness level, suicide rates, and life expectancy. Each of these factors has its own dataset, and they are all linked to the Alcohol Consumption dataset via the common variable &quot;Country.&quot; Our primary variables of interest encompass Alcohol Consumption, Happiness Level, Suicide Rates, and Life Expectancy. In the context of these human factors, our exploration centers on their relationship with Alcohol Consumption. We are investigating whether countries with higher happiness levels, longer life expectancies, or elevated suicide rates are associated with higher alcohol consumption.

</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Alcohol Consumption and Happiness Levels<a rel="noopener" class="anchor-link" href="#Alcohol-Consumption-and-Happiness-Levels">&#182;</a></h4>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>Data Cleaning and Preprocessing</strong></p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

Answering the first guiding question required the merging of the two datasets by performing an inner join with country names as the primary key. To perform this completely and effectively, we performed a degree of data cleaning by ensuring that the country names between datasets match exactly. A full outer join query was performed on both datasets and mismatching country names were noted. To ensure precision, names from the &#39;Happiness Score&#39; dataset was compared to each name of the &#39;Alcohol Consumption&#39; dataset through a manual process. If names are similar (e.g. &#39;United States&#39; and &#39;United States of America&#39;) then the names from the &#39;Happiness Score&#39; dataset was renamed to match the names from the &#39;Alcohol Consumption&#39; data set. Despite this effort, not all names in the &#39;Happiness Score&#39; dataset had a corresponding name in the &#39;Alcohol Consumption&#39; data set due to different guidelines of which countries are recognized by organizations. After this process of data cleaning, the final merged dataset contains 146 rows (records for 10 countries were not found in the &#39;Happiness Score&#39; dataset) and 3 columns (country names, happiness score, and alcohol consumption per capita in litres).

</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">query_string_out_countries_happiness</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT DISTINCT `Country or region`, Score</span>
<span class="s1">FROM alcohol_consumption</span>
<span class="s1">LEFT JOIN happiness_scores</span>
<span class="s1">ON alcohol_consumption.`Location` = happiness_scores.`Country or region`</span>
<span class="s1">WHERE happiness_scores.`Country or region` IS NULL</span>
<span class="s1">OR alcohol_consumption.`Location` IS NULL</span>
<span class="s1">UNION</span>
<span class="s1">SELECT DISTINCT `Country or region`, Score</span>
<span class="s1">FROM alcohol_consumption</span>
<span class="s1">RIGHT JOIN happiness_scores</span>
<span class="s1">ON alcohol_consumption.`Location` = happiness_scores.`Country or region`</span>
<span class="s1">WHERE alcohol_consumption.`Location` IS NULL</span>
<span class="s1">OR happiness_scores.`Country or region` IS NULL;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">query_table_out_countries_happiness</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">((</span><span class="n">query_string_out_countries_happiness</span><span class="p">),</span> <span class="n">engine</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">query_table_out_countries_happiness</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country or region</th>
      <th>Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>United Kingdom</td>
      <td>7.054</td>
    </tr>
    <tr>
      <th>2</th>
      <td>United States</td>
      <td>6.892</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Czech Republic</td>
      <td>6.852</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Taiwan</td>
      <td>6.446</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Trinidad &amp; Tobago</td>
      <td>6.192</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Kosovo</td>
      <td>6.100</td>
    </tr>
    <tr>
      <th>7</th>
      <td>South Korea</td>
      <td>5.895</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Bolivia</td>
      <td>5.779</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Northern Cyprus</td>
      <td>5.718</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Russia</td>
      <td>5.648</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Moldova</td>
      <td>5.529</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Hong Kong</td>
      <td>5.430</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Turkey</td>
      <td>5.373</td>
    </tr>
    <tr>
      <th>14</th>
      <td>North Macedonia</td>
      <td>5.274</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Vietnam</td>
      <td>5.175</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Ivory Coast</td>
      <td>4.944</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Congo (Brazzaville)</td>
      <td>4.812</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Laos</td>
      <td>4.796</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Venezuela</td>
      <td>4.707</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Palestinian Territories</td>
      <td>4.696</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Iran</td>
      <td>4.548</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Congo (Kinshasa)</td>
      <td>4.418</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Swaziland</td>
      <td>4.212</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Syria</td>
      <td>3.462</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Tanzania</td>
      <td>3.231</td>
    </tr>
    <tr>
      <th>26</th>
      <td>South Sudan</td>
      <td>2.853</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">query_string_out_countries_alcohol</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT DISTINCT `Location`</span>
<span class="s1">FROM alcohol_consumption</span>
<span class="s1">LEFT JOIN happiness_scores</span>
<span class="s1">ON alcohol_consumption.`Location` = happiness_scores.`Country or region`</span>
<span class="s1">WHERE DIM1 = &#39;All types&#39;</span>
<span class="s1">AND happiness_scores.`Country or region` IS NULL</span>
<span class="s1">OR alcohol_consumption.`Location` IS NULL</span>
<span class="s1">UNION</span>
<span class="s1">SELECT DISTINCT `Location`</span>
<span class="s1">FROM alcohol_consumption</span>
<span class="s1">RIGHT JOIN happiness_scores</span>
<span class="s1">ON alcohol_consumption.`Location` = happiness_scores.`Country or region`</span>
<span class="s1">WHERE DIM1 = &#39;All types&#39;</span>
<span class="s1">AND alcohol_consumption.`Location` IS NULL</span>
<span class="s1">OR happiness_scores.`Country or region` IS NULL;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">query_table_out_countries_alcohol</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">((</span><span class="n">query_string_out_countries_alcohol</span><span class="p">),</span> <span class="n">engine</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">query_table_out_countries_alcohol</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Location</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Iran (Islamic Republic of)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Syrian Arab Republic</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Djibouti</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Tonga</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Timor-Leste</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Kiribati</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Oman</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Democratic Republic of the Congo</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Brunei Darussalam</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Tuvalu</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Eritrea</td>
    </tr>
    <tr>
      <th>11</th>
      <td>T&#252;rkiye</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Solomon Islands</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Papua New Guinea</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Maldives</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Micronesia (Federated States of)</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Vanuatu</td>
    </tr>
    <tr>
      <th>17</th>
      <td>C&#244;te d’Ivoire</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Andorra</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Antigua and Barbuda</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Czechia</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Cook Islands</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Samoa</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Nauru</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Venezuela (Bolivarian Republic of)</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Fiji</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Bolivia (Plurinational State of)</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Guinea-Bissau</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Viet Nam</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Democratic People&#39;s Republic of Korea</td>
    </tr>
    <tr>
      <th>30</th>
      <td>The former Yugoslav Republic of Macedonia</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Sao Tome and Principe</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Cuba</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Cabo Verde</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Guyana</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Congo</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Trinidad and Tobago</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Angola</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Belize</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Equatorial Guinea</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Dominica</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Suriname</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Russian Federation</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Republic of Moldova</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Saint Vincent and the Grenadines</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Eswatini</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Republic of Korea</td>
    </tr>
    <tr>
      <th>47</th>
      <td>United Republic of Tanzania</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Lao People&#39;s Democratic Republic</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Niue</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Grenada</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Saint Kitts and Nevis</td>
    </tr>
    <tr>
      <th>52</th>
      <td>United States of America</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Saint Lucia</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Seychelles</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Bahamas</td>
    </tr>
    <tr>
      <th>56</th>
      <td>United Kingdom of Great Britain and Northern I...</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Barbados</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Sudan</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>Examining the Relationship between Happiness and Alcohol Consumption</strong></p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

Before analyzing the relationship between happiness and alcohol in detail, a superficial analysis was conducted by looking at the top 10 countries ranked by happiness score and also ranked by alcohol consumption. A comparison was made between the two factors, and countries that appear in both top 10 lists was noted. Only one country (Austria) appeared in both lists. The happiness scores and alcohol consumption levels in these lists also appear to be related: countries with higher happiness scores also appear to have higher alcohol consumption and vice-versa.

</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">happiness_country_old</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;United Kingdom&#39;</span><span class="p">,</span>
<span class="s1">&#39;United States&#39;</span><span class="p">,</span>
<span class="s1">&#39;Czech Republic&#39;</span><span class="p">,</span>
<span class="s1">&#39;Trinidad &amp; Tobago&#39;</span><span class="p">,</span>
<span class="s1">&#39;South Korea&#39;</span><span class="p">,</span>
<span class="s1">&#39;Bolivia&#39;</span><span class="p">,</span>
<span class="s1">&#39;Russia&#39;</span><span class="p">,</span>
<span class="s1">&#39;Moldova&#39;</span><span class="p">,</span>
<span class="s1">&#39;Turkey&#39;</span><span class="p">,</span>
<span class="s1">&#39;North Macedonia&#39;</span><span class="p">,</span>
<span class="s1">&#39;Vietnam&#39;</span><span class="p">,</span>
<span class="s1">&#39;Ivory Coast&#39;</span><span class="p">,</span>
<span class="s1">&#39;Laos&#39;</span><span class="p">,</span>
<span class="s1">&#39;Venezuela&#39;</span><span class="p">,</span>
<span class="s1">&#39;Iran&#39;</span><span class="p">,</span>
<span class="s1">&#39;Swaziland&#39;</span><span class="p">,</span>
<span class="s1">&#39;Syria&#39;</span><span class="p">,</span>
<span class="s1">&#39;Tanzania&#39;</span>
<span class="p">]</span>

<span class="n">happiness_country_new</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;United Kingdom of Great Britain and Northern Ireland&#39;</span><span class="p">,</span>
<span class="s1">&#39;United States of America&#39;</span><span class="p">,</span>
<span class="s1">&#39;Czechia&#39;</span><span class="p">,</span>
<span class="s1">&#39;Trinidad and Tobago&#39;</span><span class="p">,</span>
<span class="s1">&#39;Republic of Korea&#39;</span><span class="p">,</span>
<span class="s1">&#39;Bolivia (Plurinational State of)&#39;</span><span class="p">,</span>
<span class="s1">&#39;Russian Federation&#39;</span><span class="p">,</span>
<span class="s1">&#39;Republic of Moldova&#39;</span><span class="p">,</span>
<span class="s1">&#39;T&#252;rkiye&#39;</span><span class="p">,</span>
<span class="s1">&#39;The former Yugoslav Republic of Macedonia&#39;</span><span class="p">,</span>
<span class="s1">&#39;Viet Nam&#39;</span><span class="p">,</span>
<span class="s1">&#39;C&#244;te d’Ivoire&#39;</span><span class="p">,</span>
<span class="s1">&#39;Lao Peoples Democratic Republic&#39;</span><span class="p">,</span>
<span class="s1">&#39;Venezuela (Bolivarian Republic of)&#39;</span><span class="p">,</span>
<span class="s1">&#39;Iran (Islamic Republic of)&#39;</span><span class="p">,</span>
<span class="s1">&#39;Eswatini&#39;</span><span class="p">,</span>
<span class="s1">&#39;Syrian Arab Republic&#39;</span><span class="p">,</span>
<span class="s1">&#39;United Republic of Tanzania&#39;</span>
<span class="p">]</span>


<span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span> <span class="k">as</span> <span class="n">connection</span><span class="p">:</span>

    <span class="k">for</span> <span class="n">country_old</span><span class="p">,</span> <span class="n">country_new</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">happiness_country_old</span><span class="p">,</span><span class="n">happiness_country_new</span><span class="p">):</span>

        <span class="n">query_string_replace_country</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">        UPDATE happiness_scores</span>
<span class="s1">        SET `Country or region` = </span><span class="si">{}</span>
<span class="s1">        WHERE `Country or region` =  </span><span class="si">{}</span><span class="s1">;</span>
<span class="s1">        &#39;&#39;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="o">+</span><span class="n">country_new</span><span class="o">+</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">+</span><span class="n">country_old</span><span class="o">+</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)</span>

        <span class="c1"># print(query_string_replace_country)</span>
        <span class="c1"># query_table_replace_country = pd.read_sql_query((query_string_replace_country), engine)</span>
        <span class="c1"># display(query_table_replace_country)</span>
        <span class="n">connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">text</span><span class="p">(</span><span class="n">query_string_replace_country</span><span class="p">))</span>

    <span class="c1"># query_updated_table = connection.execute(text(&#39;SELECT * FROM happiness_scores&#39;))</span>
    
    <span class="c1"># for row in query_updated_table:</span>
    <span class="c1">#     print(row)</span>

    <span class="n">query_string_happiness</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    SELECT DISTINCT a.`Location`, h.Score `Happiness Score`, a.FactValueNumeric `Alcohol Consumption`</span>
<span class="s1">    FROM alcohol_consumption a</span>
<span class="s1">    INNER JOIN happiness_scores h</span>
<span class="s1">    ON a.`Location` = h.`Country or region`</span>
<span class="s1">    WHERE a.DIM1 = &#39;All types&#39;</span>
<span class="s1">    AND a.Period = &#39;2019&#39;</span>
<span class="s1">    ORDER BY `Score` DESC;</span>
<span class="s1">    &#39;&#39;&#39;</span>

    <span class="n">query_result_happiness</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">text</span><span class="p">(</span><span class="n">query_string_happiness</span><span class="p">))</span>
    <span class="c1"># query_table_happiness = query_result_happiness.fetchall()</span>
    <span class="n">query_table_happiness</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">query_result_happiness</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">query_table_happiness</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Location</th>
      <th>Happiness Score</th>
      <th>Alcohol Consumption</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Finland</td>
      <td>7.769</td>
      <td>8.23</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Denmark</td>
      <td>7.600</td>
      <td>9.16</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Norway</td>
      <td>7.554</td>
      <td>6.05</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Iceland</td>
      <td>7.494</td>
      <td>7.72</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Netherlands</td>
      <td>7.488</td>
      <td>8.23</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>142</th>
      <td>Yemen</td>
      <td>3.380</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>143</th>
      <td>Rwanda</td>
      <td>3.334</td>
      <td>6.35</td>
    </tr>
    <tr>
      <th>144</th>
      <td>United Republic of Tanzania</td>
      <td>3.231</td>
      <td>7.81</td>
    </tr>
    <tr>
      <th>145</th>
      <td>Afghanistan</td>
      <td>3.203</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>146</th>
      <td>Central African Republic</td>
      <td>3.083</td>
      <td>0.94</td>
    </tr>
  </tbody>
</table>
<p>147 rows &#215; 3 columns</p>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

To have a more complete investigation of the two factors, the data was visualized using a scatterplot.

</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">query_table_happiness</span><span class="p">[</span><span class="s1">&#39;Happiness Score&#39;</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">query_table_happiness</span><span class="p">[</span><span class="s1">&#39;Alcohol Consumption&#39;</span><span class="p">])</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">query_table_happiness</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">])</span>

<span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">std_err</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;intercept, slope, r, p, </span><span class="se">\n</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">r_value</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">p_value</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Line of Best Fit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="c1"># Finland</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">8</span><span class="p">]))</span> <span class="c1"># Canada</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">9</span><span class="p">]))</span> <span class="c1"># Austria</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">50</span><span class="p">],</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">50</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">50</span><span class="p">]))</span> <span class="c1"># Latvia</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Happiness Scores of Countries and their Alcohol Consumption&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Happiness Score&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Alcohol Consumption (litres per capita)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>intercept, slope, r, p, 
-4.61, 1.73, 0.5172, 1.9804717384275524e-11
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

From a face-value standpoint, we can see a somewhat positive linear relationship where countries with higher happiness scores also tend to have higher alcohol consumption. This relationship was better captured after performing a correlation analysis where a significant correlation coefficient of 0.5172 was found. A trend line was also generated using a linear regression model to better visualize this linear relationship.

</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Alcohol Consumption and Life Expectancy<a rel="noopener" class="anchor-link" href="#Alcohol-Consumption-and-Life-Expectancy">&#182;</a></h4>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>Data Cleaning and Preprocessing</strong></p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

Python was used for data cleaning before storing it in the database. The column names were revised, and the row containing the original column names was removed. Three countries had inconsistent spellings between the Life Expectancy and Alcohol Consumption datasets. To address this, the country column in Life Expectancy was standardized to match the Location column in Alcohol Consumption, ensuring uniformity. 

It&#39;s important to note that even after standardization, some countries were still unique to either the Life Expectancy or Alcohol Consumption dataset. These countries will not be included in the inner join since the analysis focuses specifically on the relationship between the two variables.

The country unique to Life Expectancy dataset is

</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Get country unique to only the Life Expectancy Dataset</span>
<span class="n">join_order_alc_query</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39; </span>
<span class="s1">SELECT DISTINCT</span>
<span class="s1">    l.country</span>
<span class="s1">FROM</span>
<span class="s1">    life_expectancy AS l</span>
<span class="s1">LEFT JOIN</span>
<span class="s1">    alcohol_consumption AS a</span>
<span class="s1">ON</span>
<span class="s1">    l.country = a.Location</span>
<span class="s1">WHERE</span>
<span class="s1">    a.Location IS NULL;</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">join_order_alc_query</span><span class="p">,</span><span class="n">engine</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>South Sudan</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>The countries unique to Alcohol Consumption dataset are</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Get countries unique to only the Alcohol consumption Dataset</span>
<span class="n">join_order_alc_query</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39; </span>
<span class="s1">SELECT DISTINCT</span>
<span class="s1">    a.Location</span>
<span class="s1">FROM</span>
<span class="s1">    life_expectancy AS l</span>
<span class="s1">RIGHT JOIN</span>
<span class="s1">    alcohol_consumption AS a</span>
<span class="s1">ON</span>
<span class="s1">    l.country = a.Location</span>
<span class="s1">WHERE</span>
<span class="s1">    l.country IS NULL;</span>

<span class="s1">&#39;&#39;&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">join_order_alc_query</span><span class="p">,</span><span class="n">engine</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Location</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Andorra</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Cook Islands</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Dominica</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Nauru</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Niue</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Tuvalu</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Saint Kitts and Nevis</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>As a result, these eight countries will be excluded from the analysis due to not being present in both datasets.</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>Examining the Relationship between Life Expectancy and Alcohol Consumption</strong></p>
<p>The next step involves merging the alcohol consumption and life expectancy datasets by matching entries in the common column, which is &quot;country&quot; for the life_expectancy dataset and &quot;Location&quot; for the alcohol_consumption dataset.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Merge Average Alcohol Consumption and Life Expectancy at birth for year 2019 order by alcohol Consumption</span>
<span class="n">join_order_alc_query</span><span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT</span>
<span class="s1">    subquery.Location,</span>
<span class="s1">    subquery.AlcoholConsumption,</span>
<span class="s1">    l.le_birth_both AS LifeExpectancy</span>
<span class="s1">FROM</span>
<span class="s1">    (</span>
<span class="s1">        SELECT</span>
<span class="s1">            Location,</span>
<span class="s1">            `FactValueNumeric` AS AlcoholConsumption</span>
<span class="s1">        FROM</span>
<span class="s1">            alcohol_consumption</span>
<span class="s1">        WHERE</span>
<span class="s1">            Period = 2019</span>
<span class="s1">            AND Dim1 = &quot;All types&quot;</span>
<span class="s1">        GROUP BY</span>
<span class="s1">            Location</span>
<span class="s1">    ) AS subquery</span>
<span class="s1">JOIN</span>
<span class="s1">    life_expectancy AS l ON subquery.Location = l.country</span>
<span class="s1">WHERE</span>
<span class="s1">    l.year = 2019</span>
<span class="s1">ORDER BY</span>
<span class="s1">    subquery.AlcoholConsumption DESC;</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">join_order_alc_query</span><span class="p">,</span><span class="n">engine</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Location</th>
      <th>AlcoholConsumption</th>
      <th>LifeExpectancy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Latvia</td>
      <td>12.90</td>
      <td>75.4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Czechia</td>
      <td>12.73</td>
      <td>79.1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lithuania</td>
      <td>11.93</td>
      <td>76</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Austria</td>
      <td>11.90</td>
      <td>81.6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Antigua and Barbuda</td>
      <td>11.88</td>
      <td>76.5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Estonia</td>
      <td>11.65</td>
      <td>78.9</td>
    </tr>
    <tr>
      <th>6</th>
      <td>France</td>
      <td>11.44</td>
      <td>82.5</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Bulgaria</td>
      <td>11.18</td>
      <td>75.1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Slovenia</td>
      <td>11.05</td>
      <td>81.3</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Luxembourg</td>
      <td>11.00</td>
      <td>82.4</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Poland</td>
      <td>10.96</td>
      <td>78.3</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Romania</td>
      <td>10.96</td>
      <td>75.6</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Ireland</td>
      <td>10.91</td>
      <td>81.8</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Hungary</td>
      <td>10.79</td>
      <td>76.4</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Spain</td>
      <td>10.73</td>
      <td>83.2</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Belarus</td>
      <td>10.57</td>
      <td>74.8</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Germany</td>
      <td>10.56</td>
      <td>81.7</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Portugal</td>
      <td>10.37</td>
      <td>81.6</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Slovakia</td>
      <td>10.30</td>
      <td>78.2</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Barbados</td>
      <td>9.94</td>
      <td>76</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Merge Average Alochol Consumption and Life Expectancy at birth for year 2019 order by Life Expectancy</span>
<span class="n">join_order_le_query</span><span class="o">=</span> <span class="s1">&#39;&#39;&#39; </span>
<span class="s1">SELECT</span>
<span class="s1">    subquery.Location,</span>
<span class="s1">    l.le_birth_both AS LifeExpectancy,</span>
<span class="s1">    subquery.AlcoholConsumption</span>
<span class="s1">FROM</span>
<span class="s1">    (</span>
<span class="s1">        SELECT</span>
<span class="s1">            Location,</span>
<span class="s1">            `FactValueNumeric` AS AlcoholConsumption</span>
<span class="s1">        FROM</span>
<span class="s1">            alcohol_consumption</span>
<span class="s1">        WHERE</span>
<span class="s1">            Period = 2019</span>
<span class="s1">            AND Dim1 = &quot;All types&quot;</span>
<span class="s1">        GROUP BY</span>
<span class="s1">            Location</span>
<span class="s1">    ) AS subquery</span>
<span class="s1">JOIN</span>
<span class="s1">    life_expectancy AS l ON subquery.Location = l.country</span>
<span class="s1">WHERE</span>
<span class="s1">    l.year = 2019</span>
<span class="s1">ORDER BY</span>
<span class="s1">    LifeExpectancy DESC;</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">join_order_le_query</span><span class="p">,</span><span class="n">engine</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Location</th>
      <th>LifeExpectancy</th>
      <th>AlcoholConsumption</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Japan</td>
      <td>84.3</td>
      <td>8.36</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Switzerland</td>
      <td>83.4</td>
      <td>9.41</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Republic of Korea</td>
      <td>83.3</td>
      <td>7.74</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Singapore</td>
      <td>83.2</td>
      <td>1.81</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Spain</td>
      <td>83.2</td>
      <td>10.73</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Cyprus</td>
      <td>83.1</td>
      <td>9.59</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Australia</td>
      <td>83</td>
      <td>9.51</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Italy</td>
      <td>83</td>
      <td>7.65</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Israel</td>
      <td>82.6</td>
      <td>3.07</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Norway</td>
      <td>82.6</td>
      <td>6.05</td>
    </tr>
    <tr>
      <th>10</th>
      <td>France</td>
      <td>82.5</td>
      <td>11.44</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Luxembourg</td>
      <td>82.4</td>
      <td>11.00</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Sweden</td>
      <td>82.4</td>
      <td>7.10</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Iceland</td>
      <td>82.3</td>
      <td>7.72</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Canada</td>
      <td>82.2</td>
      <td>8.00</td>
    </tr>
    <tr>
      <th>15</th>
      <td>New Zealand</td>
      <td>82</td>
      <td>9.17</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Malta</td>
      <td>81.9</td>
      <td>8.07</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Ireland</td>
      <td>81.8</td>
      <td>10.91</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Netherlands</td>
      <td>81.8</td>
      <td>8.23</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Germany</td>
      <td>81.7</td>
      <td>10.56</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Function to compare Categories of Life Expeectancy and Alcohol consumption</span>

<span class="k">def</span> <span class="nf">intersect_countries</span><span class="p">(</span><span class="n">criteria_alcohol</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">criteria_life_expectancy</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Fetch data based on &#39;criteria_alcohol&#39; and &#39;num&#39;</span>
    <span class="k">if</span> <span class="n">criteria_alcohol</span> <span class="o">==</span> <span class="s2">&quot;top&quot;</span><span class="p">:</span>        
        <span class="n">df_alcohol</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;select subquery.Location, l.le_birth_both as LifeExpectancy ,subquery.AlcoholConsumption from (SELECT Location, `FactValueNumeric` as AlcoholConsumption from alcohol_consumption WHERE Period= 2019 AND Dim1= &quot;All types&quot; group by Location) as subquery join life_expectancy  as l on subquery.Location= l.country where l.year=2019 order by AlcoholConsumption DESC LIMIT </span><span class="si">{</span><span class="n">num</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">criteria_alcohol</span> <span class="o">==</span> <span class="s2">&quot;bottom&quot;</span><span class="p">:</span>
        <span class="n">df_alcohol</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;select subquery.Location, l.le_birth_both as LifeExpectancy ,subquery.AlcoholConsumption from (SELECT Location, `FactValueNumeric` as AlcoholConsumption from alcohol_consumption WHERE Period= 2019 AND Dim1= &quot;All types&quot; group by Location) as subquery join life_expectancy  as l on subquery.Location= l.country where l.year=2019 order by AlcoholConsumption ASC LIMIT </span><span class="si">{</span><span class="n">num</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid value for &#39;criteria_alcohol&#39;&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># Fetch data based on &#39;criteria_life_expectancy&#39; and &#39;num&#39;</span>
    <span class="k">if</span> <span class="n">criteria_life_expectancy</span> <span class="o">==</span> <span class="s2">&quot;top&quot;</span><span class="p">:</span>
        <span class="n">df_life_expectancy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;select subquery.Location, l.le_birth_both as LifeExpectancy ,subquery.AlcoholConsumption from (SELECT Location, `FactValueNumeric` as AlcoholConsumption from alcohol_consumption WHERE Period= 2019 AND Dim1= &quot;All types&quot; group by Location) as subquery join life_expectancy  as l on subquery.Location= l.country where l.year=2019 order by LifeExpectancy DESC LIMIT </span><span class="si">{</span><span class="n">num</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">criteria_life_expectancy</span> <span class="o">==</span> <span class="s2">&quot;bottom&quot;</span><span class="p">:</span>
        <span class="n">df_life_expectancy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;select subquery.Location, l.le_birth_both as LifeExpectancy ,subquery.AlcoholConsumption from (SELECT Location, `FactValueNumeric` as AlcoholConsumption from alcohol_consumption WHERE Period= 2019 AND Dim1= &quot;All types&quot; group by Location) as subquery join life_expectancy  as l on subquery.Location= l.country where l.year=2019 order by LifeExpectancy ASC LIMIT </span><span class="si">{</span><span class="n">num</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid value for &#39;criteria_life_expectancy&#39;&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># Get intersection between the two fethched data</span>
    <span class="n">intersection_countries</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">df_alcohol</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">df_life_expectancy</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">]))</span>

    <span class="c1"># Then print these common countries</span>
    <span class="k">for</span> <span class="n">country</span> <span class="ow">in</span> <span class="n">intersection_countries</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">country</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Compare Top 10 alcohol consumption and Bottom 10 Life Expectancy Countries</span>
<span class="n">intersect_countries</span><span class="p">(</span><span class="n">criteria_alcohol</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">criteria_life_expectancy</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Compare Bottom 10 alcohol consumption and Top 10 Life Expectancy Countries</span>
<span class="n">intersect_countries</span><span class="p">(</span><span class="n">criteria_alcohol</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="n">criteria_life_expectancy</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Compare Bottom 10 alcohol consumption and Bottom 10 Life Expectancy Countries</span>
<span class="n">intersect_countries</span><span class="p">(</span><span class="n">criteria_alcohol</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="n">criteria_life_expectancy</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Somalia
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Compare Top 10 alcohol consumption and Top 10 Life Expectancy Countries</span>
<span class="n">intersect_countries</span><span class="p">(</span><span class="n">criteria_alcohol</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">criteria_life_expectancy</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Compare Top 20 alcohol consumption and Bottom 20 Life Expectancy Countries</span>
<span class="n">intersect_countries</span><span class="p">(</span><span class="n">criteria_alcohol</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">criteria_life_expectancy</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Compare Bottom 20 alcohol consumption and Top 20 Life Expectancy Countries</span>
<span class="n">intersect_countries</span><span class="p">(</span><span class="n">criteria_alcohol</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="n">criteria_life_expectancy</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Compare Bottom 20 alcohol consumption and Bottom 20 Life Expectancy Countries</span>
<span class="n">intersect_countries</span><span class="p">(</span><span class="n">criteria_alcohol</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="n">criteria_life_expectancy</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Somalia
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Compare Top 20 alcohol consumption and Top 20 Life Expectancy Countries</span>
<span class="n">intersect_countries</span><span class="p">(</span><span class="n">criteria_alcohol</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">criteria_life_expectancy</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>France
Spain
Luxembourg
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

The presence of common countries in both the top 15 for alcohol consumption and life expectancy suggests a potential postive correlation. 
We will proceed to create a scatter plot to visually represent and explore the relationship between alcohol consumption and life expectancy

</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Get a dataframe with Country, Alcohol Consumption and Life Expectancy information</span>
<span class="n">df_alcohol_le</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">join_order_alc_query</span><span class="p">,</span><span class="n">engine</span><span class="p">)</span>

<span class="n">df_alcohol_le</span><span class="p">[</span><span class="s2">&quot;LifeExpectancy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_alcohol_le</span><span class="p">[</span><span class="s2">&quot;LifeExpectancy&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>  <span class="c1">#Change the datatype to float</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Create a scatter plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Scatter plot for all countries</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_alcohol_le</span><span class="p">[</span><span class="s1">&#39;LifeExpectancy&#39;</span><span class="p">],</span> <span class="n">df_alcohol_le</span><span class="p">[</span><span class="s1">&#39;AlcoholConsumption&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;All Countries&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Add labels and a title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Alcohol Consumption (litres per capita)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Life Expectancy (years)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Scatter Plot: Alcohol Consumption against Life Expectancy&#39;</span><span class="p">)</span>

<span class="c1"># Show a legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Display the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://" class="jp-needs-light-background"/>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Calculate the correlation coefficient</span>

<span class="n">corr_alcohol_le</span><span class="o">=</span> <span class="n">df_alcohol_le</span><span class="p">[</span><span class="s2">&quot;AlcoholConsumption&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">df_alcohol_le</span><span class="p">[</span><span class="s2">&quot;LifeExpectancy&quot;</span><span class="p">])</span>
<span class="n">corr_alcohol_le</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>0.48520082720422864</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

The scatter plot reveals a positive correlation. The calculated correlation coefficient of 0.4852 supports this, indicating a moderate positive correlation between alcohol consumption and life expectancy. This suggests that, in the dataset, these two variables tend to move in the same direction. In simpler terms, higher life expectancy is associated with higher alcohol consumption and vice versa.

</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Alcohol Consumption and Suicide Rates<a rel="noopener" class="anchor-link" href="#Alcohol-Consumption-and-Suicide-Rates">&#182;</a></h4>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>Data Cleaning and Preprocessing</strong></p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

We first compare the alcohol_consumption and suicide_rates datasets to identify countries present in one dataset but absent in the other.

The rationale behind this is to highlight any discrepancies or mismatches in the country entries between the two datasets. This information could be valuable for data reconciliation, ensuring data consistency, and identifying areas where data may need further investigation or reconciliation. It provides a clear understanding of the countries that exist in one dataset but not in the other, aiding in the comparison and validation of the datasets.

</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">suicide_check_discrepancy</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>

<span class="s2">-- Countries in alcohol_consumption but not in suicide_rates</span>
<span class="s2">SELECT </span>
<span class="s2">    distinct A.Location AS Country,</span>
<span class="s2">    &#39;alcohol_consumption&#39; AS SourceTable</span>
<span class="s2">FROM</span>
<span class="s2">    alcohol_consumption A</span>
<span class="s2">LEFT JOIN</span>
<span class="s2">    suicide_rates sr</span>
<span class="s2">ON</span>
<span class="s2">    A.Location = sr.GEO_NAME_SHORT</span>
<span class="s2">WHERE</span>
<span class="s2">    sr.GEO_NAME_SHORT IS NULL</span>
<span class="s2">UNION</span>
<span class="s2">-- Countries in suicide_rates but not in alcohol_consumption</span>
<span class="s2">SELECT </span>
<span class="s2">    distinct sr.GEO_NAME_SHORT AS Country,</span>
<span class="s2">    &#39;suicide_rates&#39; AS SourceTable</span>
<span class="s2">FROM</span>
<span class="s2">    alcohol_consumption A</span>
<span class="s2">RIGHT JOIN</span>
<span class="s2">    suicide_rates sr</span>
<span class="s2">ON</span>
<span class="s2">    A.Location = sr.GEO_NAME_SHORT</span>
<span class="s2">WHERE</span>
<span class="s2">    A.Location IS NULL;</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1">#suicide_check_discrepancy_table = pd.read_sql_query(suicide_check_discrepancy, engine)</span>
<span class="c1">#suicide_check_discrepancy_table</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country</th>
      <th>SourceTable</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Andorra</td>
      <td>alcohol_consumption</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Cook Islands</td>
      <td>alcohol_consumption</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Dominica</td>
      <td>alcohol_consumption</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Nauru</td>
      <td>alcohol_consumption</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Netherlands</td>
      <td>alcohol_consumption</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Niue</td>
      <td>alcohol_consumption</td>
    </tr>
    <tr>
      <th>6</th>
      <td>T&#252;rkiye</td>
      <td>alcohol_consumption</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Tuvalu</td>
      <td>alcohol_consumption</td>
    </tr>
    <tr>
      <th>8</th>
      <td>The former Yugoslav Republic of Macedonia</td>
      <td>alcohol_consumption</td>
    </tr>
    <tr>
      <th>9</th>
      <td>C&#244;te d’Ivoire</td>
      <td>alcohol_consumption</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Saint Kitts and Nevis</td>
      <td>alcohol_consumption</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Africa</td>
      <td>suicide_rates</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Americas</td>
      <td>suicide_rates</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Eastern Mediterranean</td>
      <td>suicide_rates</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Europe</td>
      <td>suicide_rates</td>
    </tr>
    <tr>
      <th>15</th>
      <td>World</td>
      <td>suicide_rates</td>
    </tr>
    <tr>
      <th>16</th>
      <td>North Macedonia</td>
      <td>suicide_rates</td>
    </tr>
    <tr>
      <th>17</th>
      <td>C&#195;&#180;te d&#39;Ivoire</td>
      <td>suicide_rates</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Netherlands (Kingdom of the)</td>
      <td>suicide_rates</td>
    </tr>
    <tr>
      <th>19</th>
      <td>South-East Asia</td>
      <td>suicide_rates</td>
    </tr>
    <tr>
      <th>20</th>
      <td>South Sudan</td>
      <td>suicide_rates</td>
    </tr>
    <tr>
      <th>21</th>
      <td>High-income economies</td>
      <td>suicide_rates</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Low-income economies</td>
      <td>suicide_rates</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Turkey</td>
      <td>suicide_rates</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Lower-middle-income economies</td>
      <td>suicide_rates</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Upper-middle-income economies</td>
      <td>suicide_rates</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Western Pacific</td>
      <td>suicide_rates</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">
In our pursuit of standardized naming conventions across both datasets, it becomes necessary to harmonize certain country values in the &quot;suicide_rates&quot; table to align seamlessly with those in the &quot;alcohol_consumption&quot; table. The identified countries for this alignment are as follows:
</div><ul>
<li><code>C&#195;&#180;te d&#39;Ivoire</code> -&gt; <code>C&#244;te d’Ivoire</code></li>
<li><code>Netherlands (Kingdom of the)</code> -&gt; <code>Netherlands</code></li>
<li><code>Turkey</code> -&gt; <code>T&#252;rkiye</code></li>
<li><code>North Macedonia</code> -&gt; <code>The former Yugoslav Republic of Macedonia</code></li>
</ul>
<div style="text-align: justify;">
This update process ensures not only uniformity in the representation of countries but also facilitates a more cohesive integration of data, laying the groundwork for precise and consistent analyses across both datasets. 
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>

    <span class="n">update_turkey</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    UPDATE suicide_rates</span>
<span class="s2">    SET GEO_NAME_SHORT = &#39;T&#252;rkiye&#39;</span>
<span class="s2">    WHERE GEO_NAME_SHORT = &#39;Turkey&#39;;</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">update_netherlands</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>

<span class="s2">    UPDATE suicide_rates</span>
<span class="s2">    SET GEO_NAME_SHORT = &#39;Netherlands&#39;</span>
<span class="s2">    WHERE GEO_NAME_SHORT = &#39;Netherlands (Kingdom of the)&#39;;</span>

<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">update_macedonia</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>

<span class="s2">    UPDATE suicide_rates</span>
<span class="s2">    SET GEO_NAME_SHORT = &quot;The former Yugoslav Republic of Macedonia&quot;</span>
<span class="s2">    WHERE GEO_NAME_SHORT = &quot;North Macedonia&quot;;</span>

<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">update_cote</span> <span class="o">=</span> <span class="n">sq</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>

<span class="s2">    UPDATE suicide_rates</span>
<span class="s2">    SET GEO_NAME_SHORT = &quot;C&#244;te d’Ivoire&quot;</span>
<span class="s2">    WHERE GEO_NAME_SHORT = &quot;C&#195;&#180;te d&#39;Ivoire&quot;;</span>

<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>

    
    <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">update_turkey</span><span class="p">)</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">update_netherlands</span><span class="p">)</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">update_macedonia</span><span class="p">)</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">update_cote</span><span class="p">)</span>

    <span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span> <span class="c1"># commit these changes to the database</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

Subsequent to the identification and rectification of naming inconsistencies between the &quot;alcohol_consumption&quot; and &quot;suicide_rates&quot; datasets, an inner join operation will be executed to answer our guiding question later. It is important to acknowledge that the &quot;suicide_rates&quot; dataset incorporates regions in addition to countries within a particular column. As a result, these regions are forfeited during the inner join process, given that the &quot;alcohol_consumption&quot; dataset exclusively contains country-level data.

Conversely, there are instances where certain countries are present in the &quot;alcohol_consumption&quot; dataset but notably absent in the &quot;suicide_rates&quot; dataset. Regrettably, these countries are overlooked in the inner join operation, as it operates under the constraint of only considering matching entries. The rationale here is to retain consistency and coherence in the merged dataset, prioritizing uniformity in the countries shared by both datasets.

This approach ensures that the resulting dataset is streamlined and focused exclusively on the intersection of countries present in both &quot;alcohol_consumption&quot; and &quot;suicide_rates&quot; datasets, disregarding regions and countries that do not align between the two datasets. By disregarding regions and countries that do not align between the two datasets, our objective is to create a dataset that facilitates a meaningful and direct comparison of alcohol consumption levels and suicide rates. This targeted dataset serves as a foundation for insightful analyses, allowing for a clear examination of the relationship between these variables across shared countries.

</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p><strong>Examining the Relationship between Suicide Rate and Alcohol Consumption</strong></p>
<div style="text-align: justify;">

The SQL query below aims to examine the relationship between alcohol consumption and suicide rates across various countries. By joining the &quot;alcohol_consumption&quot; and &quot;suicide_rates&quot; datasets on the basis of the common identifier &quot;Country,&quot; the query filters the data to focus on the year 2019, considering all types of alcohol consumption and both genders. The calculated average suicide rate for each country is then paired with its corresponding alcohol consumption level. The results, sorted in descending order of alcohol consumption, provide insights into potential correlations or patterns between these two variables, contributing to a nuanced understanding of their interplay on a global scale.

</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">suicide_rs_1</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>

<span class="s2">SELECT </span>
<span class="s2">    A.Location AS Country,</span>
<span class="s2">    A.FactValueNumeric AS AlcoholConsumption,</span>
<span class="s2">    AVG(sr.Value_Numeric) as SuicideRate</span>
<span class="s2">FROM </span>
<span class="s2">    alcohol_consumption A</span>
<span class="s2">INNER JOIN</span>
<span class="s2">    suicide_rates sr</span>
<span class="s2">ON</span>
<span class="s2">    A.Location = sr.GEO_NAME_SHORT</span>
<span class="s2">WHERE</span>
<span class="s2">    A.Period = 2019 and</span>
<span class="s2">    A.Dim1  = &#39;All types&#39; and</span>
<span class="s2">    sr.DIM_TIME = 2019 and </span>
<span class="s2">    sr.DIM_SEX = &#39;Total&#39;</span>
<span class="s2">group by </span>
<span class="s2">	sr.GEO_NAME_SHORT</span>
<span class="s2">ORDER BY </span>
<span class="s2">    AlcoholConsumption DESC;</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">suicide_rs_1_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">suicide_rs_1</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="n">suicide_rs_1_table</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country</th>
      <th>AlcoholConsumption</th>
      <th>SuicideRate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Latvia</td>
      <td>12.90</td>
      <td>21.052067</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Czechia</td>
      <td>12.73</td>
      <td>13.487283</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lithuania</td>
      <td>11.93</td>
      <td>27.189467</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Austria</td>
      <td>11.90</td>
      <td>16.428050</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Antigua and Barbuda</td>
      <td>11.88</td>
      <td>0.341833</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>176</th>
      <td>Bangladesh</td>
      <td>0.00</td>
      <td>6.333333</td>
    </tr>
    <tr>
      <th>177</th>
      <td>Kuwait</td>
      <td>0.00</td>
      <td>4.940833</td>
    </tr>
    <tr>
      <th>178</th>
      <td>Mauritania</td>
      <td>0.00</td>
      <td>15.281667</td>
    </tr>
    <tr>
      <th>179</th>
      <td>Saudi Arabia</td>
      <td>0.00</td>
      <td>6.890833</td>
    </tr>
    <tr>
      <th>180</th>
      <td>Somalia</td>
      <td>0.00</td>
      <td>32.130833</td>
    </tr>
  </tbody>
</table>
<p>181 rows &#215; 3 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Set the style for the plot</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>

<span class="c1"># Create a scatter plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">scatter_plot</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;SuicideRate&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;AlcoholConsumption&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">suicide_rs_1_table</span><span class="p">)</span>  <span class="c1"># Switched x and y axes</span>

<span class="c1"># Add labels and title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Relationship between Suicide Rate and Alcohol Consumption&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Suicide Rate&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Alcohol Consumption&quot;</span><span class="p">)</span>

<span class="c1"># Sort the table by SuicideRate in descending order</span>
<span class="n">sorted_table</span> <span class="o">=</span> <span class="n">suicide_rs_1_table</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;AlcoholConsumption&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Add annotations for the top 10 and bottom 10 countries</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sorted_table</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">line</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="ow">or</span> <span class="n">line</span> <span class="o">&gt;=</span> <span class="n">sorted_table</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">10</span><span class="p">:</span>
        <span class="n">scatter_plot</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="n">sorted_table</span><span class="o">.</span><span class="n">SuicideRate</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">line</span><span class="p">],</span>
            <span class="n">sorted_table</span><span class="o">.</span><span class="n">AlcoholConsumption</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">line</span><span class="p">],</span>
            <span class="n">sorted_table</span><span class="o">.</span><span class="n">Country</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">line</span><span class="p">],</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
            <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span>
        <span class="p">)</span>

<span class="c1"># Identify the country with the highest suicide rate</span>
<span class="n">sorted_table1</span> <span class="o">=</span> <span class="n">suicide_rs_1_table</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;SuicideRate&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">highest_suicide_rate_country</span> <span class="o">=</span> <span class="n">sorted_table1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span>

<span class="c1"># Annotate the point for the country with the highest suicide rate</span>
<span class="n">scatter_plot</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="sa">f</span><span class="s1">&#39;Highest Suicide Rate: </span><span class="si">{</span><span class="n">highest_suicide_rate_country</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">sorted_table1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;SuicideRate&#39;</span><span class="p">],</span> <span class="n">sorted_table1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;AlcoholConsumption&#39;</span><span class="p">]),</span>  <span class="c1"># Switched x and y coordinates</span>
    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">sorted_table1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;SuicideRate&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="n">sorted_table1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;AlcoholConsumption&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">),</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">),</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
    <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span>
<span class="p">)</span>

<span class="c1"># Show the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

The results of the SQL query exploring the relationship between alcohol consumption and suicide rates, as visually represented in the scatterplot above, unveil a captivating observation. In the scatterplot, the top 10 and bottom 10 countries are distinctly labeled to draw attention to their positioning in terms of alcohol consumption. This labeling offers a focused insight into the countries with the highest and lowest alcohol consumption levels, enriching the interpretative value of the visualization. Contrary to the expected association where higher alcohol consumption would align with elevated suicide rates, the data exposes a nuanced and seemingly contradictory pattern.

Examining the scatterplot, countries like Latvia, Czechia, and Lithuania showcase substantial alcohol consumption levels, ranging from 11.90 to 12.90. However, their corresponding suicide rates exhibit significant variations. Latvia, despite having a relatively high alcohol consumption of 12.90, reports a suicide rate of 21.05. Conversely, Czechia, with a similar level of alcohol consumption (12.73), exhibits a markedly lower suicide rate of 13.49. Moreover, we can also see how some countries like Somalia, where there is no reported alcohol consumption, yet the suicide rate surpasses that of countries with high alcohol consumption. Additionally, Lesotho, the country with the highest suicide rate, has relatively low alcohol consumption. This intriguing discrepancy persists throughout the dataset, with certain countries displaying minimal or no suicide rates despite non-zero alcohol consumption.

The absence of a clear correlation challenges the simplistic assumption that higher alcohol consumption inevitably leads to higher suicide rates. This intricacy may stem from multifaceted factors influencing suicide rates, such as socio-economic conditions, cultural attitudes, mental health support systems, and governmental policies. In light of these findings, it becomes imperative to delve deeper into the contextual nuances of each country, considering socio-cultural dynamics and mental health frameworks. While alcohol consumption is undoubtedly a factor, its impact on suicide rates appears to be intricately interwoven with a spectrum of other determinants. Further analysis and exploration of these contributing factors would provide a more comprehensive understanding of the complex relationship between alcohol consumption and suicide rates across diverse nations.

</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>Economic Factors<a rel="noopener" class="anchor-link" href="#Economic-Factors">&#182;</a></h3>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">
Analyzing the relationship between alcohol consumption and a country&#39;s well-being involves a focus on key economic factors, including GDP per capita, inflation, and the unemployment rate. GDP per capita is a crucial metric as it provides a more nuanced understanding of economic prosperity by considering income distribution among the population. A higher GDP per capita generally indicates greater individual wealth and a higher standard of living. Inflation, reflecting the rate of price increases, can influence the purchasing power of individuals, impacting their overall welfare. Additionally, the unemployment rate, indicating the proportion of the workforce without jobs, offers insights into labor market dynamics and potential challenges affecting income and job security. By incorporating these economic indicators alongside alcohol consumption patterns, the project aims to unravel potential correlations and contribute valuable insights into the complex interplay between economic conditions, individual prosperity, and the well-being of a nation.
</div><p>Before delving into the analysis of relationships, we conducted an initial exploration of the economic indicator dataset. Our approach involved several steps:</p>
<ol>
<li>We examined the dataset to comprehend the number of countries represented in GDP, inflation, and unemployment rate indicators, as well as in the alcohol consumption datasets.</li>
<li>Prior to joining the data, we investigated the presence of NULL values for each economic indicator. We considered whether manual mapping of these NULL values was necessary after the data integration.</li>
<li>Moving beyond the initial comparisons, we progressed to the next phase of visualizing relationships using scatterplots.</li>
</ol>
<p>By following this systematic data exploration process, we aimed to gain insights into the economic indicators and their potential relationships with other datasets.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Generate a list of countries for alcohol consumption dataset</span>
<span class="n">alcohol_countrylist_query</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;SELECT DISTINCT alcohol_consumption.`Location` </span>
<span class="s1">                               FROM alcohol_consumption</span>
<span class="s1">                               ORDER BY alcohol_consumption.`Location`;&#39;&#39;&#39;</span>

<span class="n">alcohol_countrylist</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">alcohol_countrylist_query</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="c1">#display(alcohol_countrylist)</span>
<span class="c1">#alcohol_countrylist[&quot;Location&quot;]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Alcohol Consumption and GDP per capita<a rel="noopener" class="anchor-link" href="#Alcohol-Consumption-and-GDP-per-capita">&#182;</a></h4>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

&quot;Gross domestic product per capita, constant prices&quot; expressed in constant international dollars per person is a robust metric for comparing the economic performance of different countries. It takes into account inflation, adjusts for purchasing power differences, provides a per capita measure, ensures consistency, and aligns with economic theory, making it a suitable choice for cross-country GDP analysis.

</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h5>Data Cleaning and Preprocessing<a rel="noopener" class="anchor-link" href="#Data-Cleaning-and-Preprocessing">&#182;</a></h5><div style="text-align: justify;">

Below we first list out the GDP countries that were not joined, then map them with Python. We then update the GDP country names and upload the revised dataset to the database for further query.

</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># To find out number of countries in the 2019 GDP data</span>
<span class="n">gdpcount</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">            SELECT economic_indicators.Country, </span>
<span class="s1">                economic_indicators.`Subject Descriptor`, </span>
<span class="s1">                economic_indicators.`Subject Notes`, </span>
<span class="s1">                economic_indicators.`2019`</span>
<span class="s1">            </span>
<span class="s1">            FROM economic_indicators</span>
<span class="s1">            </span>
<span class="s1">            WHERE `Subject Descriptor` = &#39;Gross domestic product per capita, constant prices&#39; </span>
<span class="s1">            AND `Subject Notes` = &#39;GDP is expressed in constant international dollars per person. Data are derived by dividing constant price purchasing-power parity (PPP) GDP by total population.&#39;</span>
<span class="s1">            AND `2019` &gt; 0</span>

<span class="s1">            ORDER BY CAST(REPLACE(`2019`, &#39;,&#39;, &#39;&#39;) AS DECIMAL(10, 3)) DESC;&#39;&#39;&#39;</span>

<span class="n">gdpcount</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">gdpcount</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="n">num_rows</span> <span class="o">=</span> <span class="n">gdpcount</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of countries in GDP: </span><span class="si">{</span><span class="n">num_rows</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># To create a complete list of GDP countries</span>
<span class="n">gdp_countries</span> <span class="o">=</span> <span class="n">gdpcount</span><span class="p">[</span><span class="s2">&quot;Country&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Number of countries in GDP: 193
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

In the query below, an inner join operation is performed between the economic indicators dataset (`economic_indicators`) and the alcohol consumption dataset (`alcohol_consumption`). The join is based on the &quot;Country&quot; column in the economic indicators dataset and the &quot;Location&quot; column in the alcohol consumption dataset.

The purpose of this join is to bring together information from both datasets where the countries match. The selected columns include relevant economic indicators such as GDP per capita in constant prices for the year 2019 (`2019` column) and alcohol consumption details for all types in the same year (`Dim1` and `FactValueNumeric` columns).

</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Inner Join the 2019 GDP from the economic indicators dataset with alcohol consumption dataset by country</span>
<span class="n">gdp2019query</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    SELECT economic_indicators.Country, </span>
<span class="s1">        economic_indicators.`Subject Descriptor`, </span>
<span class="s1">        economic_indicators.`Subject Notes`, </span>
<span class="s1">        economic_indicators.`2019`, </span>
<span class="s1">        economic_indicators.`Units`, </span>
<span class="s1">        economic_indicators.`Scale`,</span>
<span class="s1">        alcohol_consumption.`Location`,</span>
<span class="s1">        alcohol_consumption.`Dim1`, </span>
<span class="s1">        alcohol_consumption.`FactValueNumeric`</span>
<span class="s1">    </span>
<span class="s1">    FROM economic_indicators</span>
<span class="s1">    </span>
<span class="s1">    INNER JOIN alcohol_consumption ON economic_indicators.Country = alcohol_consumption.Location</span>
<span class="s1">    </span>
<span class="s1">    WHERE `Subject Descriptor` = &#39;Gross domestic product per capita, constant prices&#39; </span>
<span class="s1">    AND `Subject Notes` = &#39;GDP is expressed in constant international dollars per person. Data are derived by dividing constant price purchasing-power parity (PPP) GDP by total population.&#39;</span>
<span class="s1">    AND `2019` &gt; 0</span>
<span class="s1">    AND alcohol_consumption.Dim1 = &#39;All Types&#39;</span>
<span class="s1">    AND alcohol_consumption.Period = &#39;2019&#39;</span>
<span class="s1">    </span>
<span class="s1">    ORDER BY CAST(REPLACE(`2019`, &#39;,&#39;, &#39;&#39;) AS DECIMAL(10, 3)) DESC;&#39;&#39;&#39;</span>

<span class="n">gdp2019</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">gdp2019query</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="c1">#display(gdp2019)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

We then compare which countries from the original GDP dataset were not included in the join, providing insights into the completeness of the data and potential gaps in the analysis. This information can be valuable for understanding the coverage of the analysis and deciding how to handle countries without corresponding data in the alcohol consumption dataset.

</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Compare the list of countries joined with the complete list of GDP countries</span>
<span class="n">gdp_countries_joined</span> <span class="o">=</span> <span class="n">gdp2019</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">not_joined_countries</span> <span class="o">=</span> <span class="p">[</span><span class="n">country</span> <span class="k">for</span> <span class="n">country</span> <span class="ow">in</span> <span class="n">gdp_countries</span> <span class="k">if</span> <span class="n">country</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">gdp_countries_joined</span><span class="p">]</span>

<span class="c1">#Display the list of countries not joined</span>
<span class="nb">print</span><span class="p">(</span><span class="n">not_joined_countries</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>[&#39;Macao SAR&#39;, &#39;United States&#39;, &#39;San Marino&#39;, &#39;Hong Kong SAR&#39;, &#39;Taiwan Province of China&#39;, &#39;United Kingdom&#39;, &#39;Korea&#39;, &#39;Czech Republic&#39;, &#39;The Bahamas&#39;, &#39;Aruba&#39;, &#39;Puerto Rico&#39;, &#39;Slovak Republic&#39;, &#39;Turkey&#39;, &#39;Russia&#39;, &#39;St. Kitts and Nevis&#39;, &#39;North Macedonia&#39;, &#39;St. Lucia&#39;, &#39;Palau&#39;, &#39;Moldova&#39;, &#39;St. Vincent and the Grenadines&#39;, &#39;Islamic Republic of Iran&#39;, &#39;Kosovo&#39;, &#39;Vietnam&#39;, &#39;Bolivia&#39;, &#39;Lao P.D.R.&#39;, &#39;Venezuela&#39;, &#39;West Bank and Gaza&#39;, &#39;Kyrgyz Republic&#39;, &quot;C&#244;te d&#39;Ivoire&quot;, &#39;Republic of Congo&#39;, &#39;Sudan&#39;, &#39;Marshall Islands&#39;, &#39;Micronesia&#39;, &#39;Tanzania&#39;, &#39;The Gambia&#39;, &#39;South Sudan&#39;]
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

We utilize the `fuzzywuzzy` library to find similar country names from the alcohol consumption dataset for the countries that were not joined in the previous step. This fuzzy matching approach helps address variations or discrepancies in country names, facilitating a more comprehensive analysis by associating relevant data even when exact matches are not found.

A similarity score threshold (set at 80 for our case) is defined. The code filters the matches, creating a new dictionary named filtered_matches that only includes matches with a similarity score equal to or above the specified threshold.

</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># To find out similar names from the alcohol consumption dataset</span>
<span class="kn">from</span> <span class="nn">fuzzywuzzy</span> <span class="kn">import</span> <span class="n">process</span>

<span class="c1"># Create a dictionary with country names and their corresponding matches</span>
<span class="n">matches</span> <span class="o">=</span> <span class="p">{</span><span class="n">country</span><span class="p">:</span> <span class="n">process</span><span class="o">.</span><span class="n">extractOne</span><span class="p">(</span><span class="n">country</span><span class="p">,</span> <span class="n">alcohol_countrylist</span><span class="p">[</span><span class="s2">&quot;Location&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">country</span> <span class="ow">in</span> <span class="n">not_joined_countries</span><span class="p">}</span>

<span class="c1"># Display the matches</span>
<span class="k">for</span> <span class="n">country</span><span class="p">,</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">matches</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">country</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">match</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">threshold</span> <span class="o">=</span> <span class="mi">80</span> 
<span class="n">filtered_matches</span> <span class="o">=</span> <span class="p">{</span><span class="n">country</span><span class="p">:</span> <span class="n">match</span> <span class="k">for</span> <span class="n">country</span><span class="p">,</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">matches</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">match</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">}</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Filtered matches (threshold &gt;= </span><span class="si">{</span><span class="n">threshold</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">country</span><span class="p">,</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">filtered_matches</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">country</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">match</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Macao SAR: (&#39;Malaysia&#39;, 59, 103)
United States: (&#39;United States of America&#39;, 90, 180)
San Marino: (&#39;Mali&#39;, 68, 105)
Hong Kong SAR: (&#39;Hungary&#39;, 56, 76)
Taiwan Province of China: (&#39;China&#39;, 90, 35)
United Kingdom: (&#39;United Kingdom of Great Britain and Northern Ireland&#39;, 90, 178)
Korea: (&quot;Democratic People&#39;s Republic of Korea&quot;, 90, 46)
Czech Republic: (&#39;Central African Republic&#39;, 86, 32)
The Bahamas: (&#39;Bahamas&#39;, 90, 11)
Aruba: (&#39;Barbados&#39;, 72, 14)
Puerto Rico: (&#39;Peru&#39;, 68, 131)
Slovak Republic: (&#39;Central African Republic&#39;, 86, 32)
Turkey: (&#39;Turkmenistan&#39;, 75, 172)
Russia: (&#39;Russian Federation&#39;, 90, 139)
St. Kitts and Nevis: (&#39;Saint Kitts and Nevis&#39;, 90, 141)
North Macedonia: (&#39;The former Yugoslav Republic of Macedonia&#39;, 86, 166)
St. Lucia: (&#39;Saint Lucia&#39;, 80, 142)
Palau: (&#39;Paraguay&#39;, 62, 130)
Moldova: (&#39;Republic of Moldova&#39;, 90, 137)
St. Vincent and the Grenadines: (&#39;Saint Vincent and the Grenadines&#39;, 94, 143)
Islamic Republic of Iran: (&#39;Iran (Islamic Republic of)&#39;, 95, 80)
Kosovo: (&#39;The former Yugoslav Republic of Macedonia&#39;, 47, 166)
Vietnam: (&#39;Viet Nam&#39;, 93, 185)
Bolivia: (&#39;Bolivia (Plurinational State of)&#39;, 90, 20)
Lao P.D.R.: (&quot;Lao People&#39;s Democratic Republic&quot;, 86, 93)
Venezuela: (&#39;Venezuela (Bolivarian Republic of)&#39;, 90, 184)
West Bank and Gaza: (&#39;Saint Vincent and the Grenadines&#39;, 86, 143)
Kyrgyz Republic: (&#39;Central African Republic&#39;, 86, 32)
C&#244;te d&#39;Ivoire: (&#39;C&#244;te d’Ivoire&#39;, 100, 41)
Republic of Congo: (&#39;Congo&#39;, 90, 38)
Sudan: (&#39;Sudan&#39;, 100, 159)
Marshall Islands: (&#39;Cook Islands&#39;, 70, 39)
Micronesia: (&#39;Micronesia (Federated States of)&#39;, 90, 110)
Tanzania: (&#39;United Republic of Tanzania&#39;, 90, 179)
The Gambia: (&#39;Gambia&#39;, 90, 64)
South Sudan: (&#39;Sudan&#39;, 90, 159)

Filtered matches (threshold &gt;= 80):
United States: (&#39;United States of America&#39;, 90, 180)
Taiwan Province of China: (&#39;China&#39;, 90, 35)
United Kingdom: (&#39;United Kingdom of Great Britain and Northern Ireland&#39;, 90, 178)
Korea: (&quot;Democratic People&#39;s Republic of Korea&quot;, 90, 46)
Czech Republic: (&#39;Central African Republic&#39;, 86, 32)
The Bahamas: (&#39;Bahamas&#39;, 90, 11)
Slovak Republic: (&#39;Central African Republic&#39;, 86, 32)
Russia: (&#39;Russian Federation&#39;, 90, 139)
St. Kitts and Nevis: (&#39;Saint Kitts and Nevis&#39;, 90, 141)
North Macedonia: (&#39;The former Yugoslav Republic of Macedonia&#39;, 86, 166)
St. Lucia: (&#39;Saint Lucia&#39;, 80, 142)
Moldova: (&#39;Republic of Moldova&#39;, 90, 137)
St. Vincent and the Grenadines: (&#39;Saint Vincent and the Grenadines&#39;, 94, 143)
Islamic Republic of Iran: (&#39;Iran (Islamic Republic of)&#39;, 95, 80)
Vietnam: (&#39;Viet Nam&#39;, 93, 185)
Bolivia: (&#39;Bolivia (Plurinational State of)&#39;, 90, 20)
Lao P.D.R.: (&quot;Lao People&#39;s Democratic Republic&quot;, 86, 93)
Venezuela: (&#39;Venezuela (Bolivarian Republic of)&#39;, 90, 184)
West Bank and Gaza: (&#39;Saint Vincent and the Grenadines&#39;, 86, 143)
Kyrgyz Republic: (&#39;Central African Republic&#39;, 86, 32)
C&#244;te d&#39;Ivoire: (&#39;C&#244;te d’Ivoire&#39;, 100, 41)
Republic of Congo: (&#39;Congo&#39;, 90, 38)
Sudan: (&#39;Sudan&#39;, 100, 159)
Micronesia: (&#39;Micronesia (Federated States of)&#39;, 90, 110)
Tanzania: (&#39;United Republic of Tanzania&#39;, 90, 179)
The Gambia: (&#39;Gambia&#39;, 90, 64)
South Sudan: (&#39;Sudan&#39;, 90, 159)
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

This code below extracts Gross Domestic Product (GDP) data for the year 2019 from the economic indicators dataset, specifically targeting GDP per capita at constant prices. The SQL query filters the dataset based on relevant descriptors and positive GDP values, presenting the results in descending order of GDP. The retrieved data is then loaded into a Pandas DataFrame named `gdp2019_data`. Additionally, a dictionary called `country_name_mapping` is employed to standardize certain country names within the DataFrame. 

</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># To extract 2019 GDP data from economic indicators dataset</span>
<span class="n">gdp2019_data</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    SELECT economic_indicators.Country, </span>
<span class="s1">        economic_indicators.`Subject Descriptor`, </span>
<span class="s1">        economic_indicators.`Subject Notes`, </span>
<span class="s1">        economic_indicators.`2019`, </span>
<span class="s1">        economic_indicators.`Units`, </span>
<span class="s1">        economic_indicators.`Scale`</span>
<span class="s1">    </span>
<span class="s1">    FROM economic_indicators</span>
<span class="s1">    </span>
<span class="s1">    WHERE `Subject Descriptor` = &#39;Gross domestic product per capita, constant prices&#39; </span>
<span class="s1">    AND `Subject Notes` = &#39;GDP is expressed in constant international dollars per person. Data are derived by dividing constant price purchasing-power parity (PPP) GDP by total population.&#39;</span>
<span class="s1">    AND `2019` &gt; 0</span>
<span class="s1">    </span>
<span class="s1">    ORDER BY CAST(REPLACE(`2019`, &#39;,&#39;, &#39;&#39;) AS DECIMAL(10, 3)) DESC;&#39;&#39;&#39;</span>

<span class="n">gdp2019_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">gdp2019_data</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>

<span class="c1"># Define a dictionary country names replaced</span>
<span class="n">country_name_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;United States&#39;</span> <span class="p">:</span> <span class="s1">&#39;United States of America&#39;</span><span class="p">,</span>
    <span class="s1">&#39;United Kingdom&#39;</span> <span class="p">:</span> <span class="s1">&#39;United Kingdom of Great Britain and Northern Ireland&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Korea&#39;</span> <span class="p">:</span> <span class="s2">&quot;Democratic People&#39;s Republic of Korea&quot;</span><span class="p">,</span>
    <span class="s1">&#39;The Bahamas&#39;</span> <span class="p">:</span> <span class="s1">&#39;Bahamas&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Russia&#39;</span> <span class="p">:</span> <span class="s1">&#39;Russian Federation&#39;</span><span class="p">,</span>
    <span class="s1">&#39;St. Kitts and Nevis&#39;</span> <span class="p">:</span> <span class="s1">&#39;Saint Kitts and Nevis&#39;</span><span class="p">,</span>
    <span class="s1">&#39;North Macedonia&#39;</span><span class="p">:</span> <span class="s1">&#39;The former Yugoslav Republic of Macedonia&#39;</span><span class="p">,</span>
    <span class="s1">&#39;St. Lucia&#39;</span> <span class="p">:</span> <span class="s1">&#39;Saint Lucia&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Moldova&#39;</span> <span class="p">:</span> <span class="s1">&#39;Republic of Moldova&#39;</span><span class="p">,</span>
    <span class="s1">&#39;St. Vincent and the Grenadines&#39;</span> <span class="p">:</span> <span class="s1">&#39;Saint Vincent and the Grenadines&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Islamic Republic of Iran&#39;</span> <span class="p">:</span> <span class="s1">&#39;Iran (Islamic Republic of)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Vietnam&#39;</span> <span class="p">:</span> <span class="s1">&#39;Viet Nam&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Bolivia&#39;</span> <span class="p">:</span> <span class="s1">&#39;Bolivia (Plurinational State of)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Lao P.D.R.&#39;</span> <span class="p">:</span> <span class="s2">&quot;Lao People&#39;s Democratic Republic&quot;</span><span class="p">,</span>
    <span class="s1">&#39;Venezuela&#39;</span><span class="p">:</span> <span class="s1">&#39;Venezuela (Bolivarian Republic of)&#39;</span><span class="p">,</span>
    <span class="s2">&quot;C&#244;te d&#39;Ivoire&quot;</span><span class="p">:</span> <span class="s2">&quot;C&#244;te d’Ivoire&quot;</span><span class="p">,</span>
    <span class="s1">&#39;Republic of Congo&#39;</span> <span class="p">:</span> <span class="s1">&#39;Congo&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Sudan&#39;</span> <span class="p">:</span> <span class="s1">&#39;Sudan&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Micronesia&#39;</span> <span class="p">:</span> <span class="s1">&#39;Micronesia (Federated States of)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Tanzania&#39;</span> <span class="p">:</span> <span class="s1">&#39;United Republic of Tanzania&#39;</span><span class="p">,</span>
    <span class="s1">&#39;The Gambia&#39;</span> <span class="p">:</span> <span class="s1">&#39;Gambia&#39;</span>
<span class="p">}</span>

<span class="c1"># Update country names</span>
<span class="n">gdp2019_data</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdp2019_data</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">country_name_mapping</span><span class="p">)</span>

<span class="c1"># Display the updated data</span>
<span class="n">display</span><span class="p">(</span><span class="n">gdp2019_data</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country</th>
      <th>Subject Descriptor</th>
      <th>Subject Notes</th>
      <th>2019</th>
      <th>Units</th>
      <th>Scale</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Macao SAR</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>119,835.59</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Luxembourg</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>115,601.89</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Singapore</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>98,411.58</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Qatar</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>91,248.78</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ireland</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>88,086.78</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>189</th>
      <td>Malawi</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>962.935</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
    </tr>
    <tr>
      <th>190</th>
      <td>Central African Republic</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>945.181</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
    </tr>
    <tr>
      <th>191</th>
      <td>Somalia</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>915.544</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
    </tr>
    <tr>
      <th>192</th>
      <td>South Sudan</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>827.106</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
    </tr>
    <tr>
      <th>193</th>
      <td>Burundi</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>751.541</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
    </tr>
  </tbody>
</table>
<p>194 rows &#215; 6 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Read to new dataset for 2019 GDP with updated names to the database</span>
<span class="c1"># gdp2019_data.to_sql(name= &#39;gdp2019_updated&#39;, con=engine, if_exists=&#39;replace&#39;, index=False)</span>
<span class="n">gdp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_table</span><span class="p">(</span><span class="s1">&#39;gdp2019_updated&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="n">gdp_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country</th>
      <th>Subject Descriptor</th>
      <th>Subject Notes</th>
      <th>2019</th>
      <th>Units</th>
      <th>Scale</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Macao SAR</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>119,835.59</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Luxembourg</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>115,601.89</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Singapore</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>98,411.58</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Qatar</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>91,248.78</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ireland</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>88,086.78</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Examining the relationship between GDP and Alcohol Consumption<a rel="noopener" class="anchor-link" href="#Examining-the-relationship-between-GDP-and-Alcohol-Consumption">&#182;</a></h4>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

Finally, with the creation of the `gdp2019_new` dataset, incorporating both the initially considered countries and those subject to standardization for consistency, a pivotal step involves another inner join with the `alcohol_consumption` dataset. This strategic move ensures a thorough integration of information, uniting the meticulously standardized GDP data with the nuances of alcohol consumption across common countries. This subsequent join serves to deepen our comprehension of the relationship between economic factors, specifically GDP per capita, and the intricate patterns of alcohol consumption. By encompassing the shared countries in this comprehensive dataset, we are well-positioned for a more exhaustive analysis that promises to illuminate the complex interdependencies between economic indicators and societal behaviors on a global scale. The enriched and standardized dataset serves as a robust foundation for exploring and extracting valuable insights into the dynamics shaping these interconnected aspects.

</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Use this new dataset to inner join with the alcohol consumption dataset</span>
<span class="n">gdp2019query2</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    SELECT gdp2019_updated.Country, </span>
<span class="s1">        gdp2019_updated.`Subject Descriptor`, </span>
<span class="s1">        gdp2019_updated.`Subject Notes`, </span>
<span class="s1">        gdp2019_updated.`2019`, </span>
<span class="s1">        gdp2019_updated.`Units`, </span>
<span class="s1">        gdp2019_updated.`Scale`,</span>
<span class="s1">        alcohol_consumption.`Location`,</span>
<span class="s1">        alcohol_consumption.`Dim1`, </span>
<span class="s1">        alcohol_consumption.`FactValueNumeric`</span>
<span class="s1">    </span>
<span class="s1">    FROM gdp2019_updated</span>
<span class="s1">    </span>
<span class="s1">    INNER JOIN alcohol_consumption ON gdp2019_updated.Country = alcohol_consumption.Location</span>
<span class="s1">    </span>
<span class="s1">    WHERE `Subject Descriptor` = &#39;Gross domestic product per capita, constant prices&#39; </span>
<span class="s1">    AND `Subject Notes` = &#39;GDP is expressed in constant international dollars per person. Data are derived by dividing constant price purchasing-power parity (PPP) GDP by total population.&#39;</span>
<span class="s1">    AND `2019` &gt; 0</span>
<span class="s1">    AND alcohol_consumption.Dim1 = &#39;All Types&#39;</span>
<span class="s1">    AND alcohol_consumption.Period = &#39;2019&#39;</span>
<span class="s1">    </span>
<span class="s1">    ORDER BY CAST(REPLACE(`2019`, &#39;,&#39;, &#39;&#39;) AS DECIMAL(10, 3)) DESC;&#39;&#39;&#39;</span>

<span class="n">gdp2019_new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">gdp2019query2</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">gdp2019_new</span><span class="p">)</span>
<span class="c1"># now we should be expected 158 countries + 21 replacements = 179 countries # 2 is missing.</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country</th>
      <th>Subject Descriptor</th>
      <th>Subject Notes</th>
      <th>2019</th>
      <th>Units</th>
      <th>Scale</th>
      <th>Location</th>
      <th>Dim1</th>
      <th>FactValueNumeric</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Luxembourg</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>115,601.89</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
      <td>Luxembourg</td>
      <td>All types</td>
      <td>11.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Singapore</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>98,411.58</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
      <td>Singapore</td>
      <td>All types</td>
      <td>1.81</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Qatar</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>91,248.78</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
      <td>Qatar</td>
      <td>All types</td>
      <td>0.96</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ireland</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>88,086.78</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
      <td>Ireland</td>
      <td>All types</td>
      <td>10.91</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Switzerland</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>71,711.85</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
      <td>Switzerland</td>
      <td>All types</td>
      <td>9.41</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>173</th>
      <td>Democratic Republic of the Congo</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>1,083.85</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
      <td>Democratic Republic of the Congo</td>
      <td>All types</td>
      <td>0.56</td>
    </tr>
    <tr>
      <th>174</th>
      <td>Malawi</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>962.935</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
      <td>Malawi</td>
      <td>All types</td>
      <td>2.04</td>
    </tr>
    <tr>
      <th>175</th>
      <td>Central African Republic</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>945.181</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
      <td>Central African Republic</td>
      <td>All types</td>
      <td>0.94</td>
    </tr>
    <tr>
      <th>176</th>
      <td>Somalia</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>915.544</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
      <td>Somalia</td>
      <td>All types</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>177</th>
      <td>Burundi</td>
      <td>Gross domestic product per capita, constant pr...</td>
      <td>GDP is expressed in constant international dol...</td>
      <td>751.541</td>
      <td>Purchasing power parity; 2017 international do...</td>
      <td>Units</td>
      <td>Burundi</td>
      <td>All types</td>
      <td>4.07</td>
    </tr>
  </tbody>
</table>
<p>178 rows &#215; 9 columns</p>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>We then visualize the results into a scatterplot as seen below.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Remove commas and convert &#39;2019&#39; column to numeric</span>
<span class="n">gdp2019_new</span><span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdp2019_new</span><span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

<span class="c1"># Scatter plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">gdp2019_new</span><span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">],</span> <span class="n">gdp2019_new</span><span class="p">[</span><span class="s1">&#39;FactValueNumeric&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>

<span class="c1"># Add labels and title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Scatter Plot of GDP vs. Alcohol Consumption&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;GDP per capita (constant international dollars)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Alcohol Consumption (FactValueNumeric)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Add country labels to each point</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">txt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gdp2019_new</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="p">(</span><span class="n">gdp2019_new</span><span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">gdp2019_new</span><span class="p">[</span><span class="s1">&#39;FactValueNumeric&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Find correlation coefficient for Alcohol vs GDP</span>
<span class="n">gdp2019_new</span><span class="p">[</span><span class="s1">&#39;FactValueNumeric&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">gdp2019_new</span><span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>0.4878970174497464</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>From the graph above a logarithmic relationship can be slightly seen with GDP. Therefore, we will try to implement log of GDP to see if it improves our model.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Remove commas and convert &#39;2019&#39; column to numeric</span>
<span class="n">gdp2019_new</span><span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdp2019_new</span><span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

<span class="c1"># Log-transform the GDP and Alcohol Consumption values</span>
<span class="n">gdp2019_new</span><span class="p">[</span><span class="s1">&#39;log_GDP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">gdp2019_new</span><span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">])</span>

<span class="c1"># Scatter plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">gdp2019_new</span><span class="p">[</span><span class="s1">&#39;log_GDP&#39;</span><span class="p">],</span> <span class="n">gdp2019_new</span><span class="p">[</span><span class="s1">&#39;FactValueNumeric&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>

<span class="c1"># Add labels and title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Scatter Plot of Log GDP vs. Alcohol Consumption&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Log GDP per capita (constant international dollars)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Alcohol Consumption&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Add country labels to each point</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">txt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gdp2019_new</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="p">(</span><span class="n">gdp2019_new</span><span class="p">[</span><span class="s1">&#39;log_GDP&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">gdp2019_new</span><span class="p">[</span><span class="s1">&#39;FactValueNumeric&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">gdp2019_new</span><span class="p">[</span><span class="s1">&#39;FactValueNumeric&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">gdp2019_new</span><span class="p">[</span><span class="s1">&#39;log_GDP&#39;</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>0.5745579465902474</pre>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

After this implementation, the data points are now less skewed, leading to a more defined linear relationship. We have a higher correlation coefficient of 0.5745579465902473, this enables us to further confirm the defined linear relationship between GDP and alcohol consumption.

In conclusion, the correlation coefficient of 0.5745579465902473 signifies a moderate correlation between the two variables. This implies that, on average, as GDP increases, alcohol consumption tends to be higher.

</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Alcohol Consumption and Inflation<a rel="noopener" class="anchor-link" href="#Alcohol-Consumption-and-Inflation">&#182;</a></h4>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

&quot;Inflation, average consumer prices&quot; is a suitable metric for comparing inflation between countries for 2019 because it considers the consumer experience, uses averages to provide stability, encompasses a diverse range of goods and services, facilitates comparability across countries, and aligns with established international measurement standards.

</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h5>Data Cleaning and Preprocessing<a rel="noopener" class="anchor-link" href="#Data-Cleaning-and-Preprocessing">&#182;</a></h5><p>Below we will clean the data just like we did for GDP.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># To find out number of countries in the 2019 Inflation data</span>
<span class="n">inflationcount</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;SELECT economic_indicators.Country, </span>
<span class="s1">                    economic_indicators.`Subject Descriptor`, </span>
<span class="s1">                    economic_indicators.`Subject Notes`, </span>
<span class="s1">                    economic_indicators.`2019` </span>

<span class="s1">                    FROM economic_indicators</span>
<span class="s1">                    </span>
<span class="s1">                    WHERE `Subject Descriptor` = &#39;Inflation, average consumer prices&#39; </span>
<span class="s1">                    AND `Subject Notes` = &quot;Expressed in averages for the year, not end-of-period data. A consumer price index (CPI) measures changes in the prices of goods and services that households consume. Such changes affect the real purchasing power of consumers&#39; incomes and their welfare. As the prices of different goods and services do not all change at the same rate, a price index can only reflect their average movement. A price index is typically assigned a value of unity, or 100, in some reference period and the values of the index for other periods of time are intended to indicate the average proportionate, or percentage, change in prices from this price reference period. Price indices can also be used to measure differences in price levels between different cities, regions or countries at the same point in time. [CPI Manual 2004, Introduction] For euro countries, consumer prices are calculated based on harmonized prices. For more information see http://epp.eurostat.ec.europa.eu/cache/ITY_OFFPUB/KS-BE-04-001/EN/KS-BE-04-001-EN.PDF.]&quot;</span>
<span class="s1">                    AND `2019` &gt; 0</span>
<span class="s1">                    </span>
<span class="s1">                    ORDER BY CAST(REPLACE(`2019`, &#39;,&#39;, &#39;&#39;) AS DECIMAL(10, 3)) DESC;&#39;&#39;&#39;</span>

<span class="n">inflationcount</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">inflationcount</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="n">num_rows</span> <span class="o">=</span> <span class="n">inflationcount</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of countries in Inflation: </span><span class="si">{</span><span class="n">num_rows</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Number of countries in Inflation: 192
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

Similarly, in the query below, an inner join operation is performed between the economic indicators dataset (`economic_indicators`) and the alcohol consumption dataset (`alcohol_consumption`). The join is based on the &quot;Country&quot; column in the economic indicators dataset and the &quot;Location&quot; column in the alcohol consumption dataset.

The purpose of this join is to bring together information from both datasets where the countries match. The selected columns include relevant economic indicators such as for Inflation, average consumer prices for the year 2019 (`2019` column) and alcohol consumption details for all types in the same year (`Dim1` and `FactValueNumeric` columns).

</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">inflation2019</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;SELECT economic_indicators.Country, </span>
<span class="s1">                    economic_indicators.`Subject Descriptor`, </span>
<span class="s1">                    economic_indicators.`Subject Notes`, </span>
<span class="s1">                    economic_indicators.`2019`, </span>
<span class="s1">                    economic_indicators.`Units`, </span>
<span class="s1">                    economic_indicators.`Scale`,</span>
<span class="s1">                    alcohol_consumption.`Location`, </span>
<span class="s1">                    alcohol_consumption.`Dim1`, </span>
<span class="s1">                    alcohol_consumption.`Period`,</span>
<span class="s1">                    alcohol_consumption.`FactValueNumeric`</span>

<span class="s1">                    FROM economic_indicators</span>

<span class="s1">                    INNER JOIN alcohol_consumption ON economic_indicators.Country = alcohol_consumption.Location</span>
<span class="s1">                    </span>
<span class="s1">                    WHERE `Subject Descriptor` = &#39;Inflation, average consumer prices&#39;</span>
<span class="s1">                    AND `Subject Notes` = &quot;Expressed in averages for the year, not end-of-period data. A consumer price index (CPI) measures changes in the prices of goods and services that households consume. Such changes affect the real purchasing power of consumers&#39; incomes and their welfare. As the prices of different goods and services do not all change at the same rate, a price index can only reflect their average movement. A price index is typically assigned a value of unity, or 100, in some reference period and the values of the index for other periods of time are intended to indicate the average proportionate, or percentage, change in prices from this price reference period. Price indices can also be used to measure differences in price levels between different cities, regions or countries at the same point in time. [CPI Manual 2004, Introduction] For euro countries, consumer prices are calculated based on harmonized prices. For more information see http://epp.eurostat.ec.europa.eu/cache/ITY_OFFPUB/KS-BE-04-001/EN/KS-BE-04-001-EN.PDF.]&quot;</span>
<span class="s1">                    AND `2019` &gt; 0</span>
<span class="s1">                    AND alcohol_consumption.Dim1 = &#39;All Types&#39;</span>
<span class="s1">                    AND alcohol_consumption.Period = &#39;2019&#39;</span>
<span class="s1">                    </span>
<span class="s1">                    ORDER BY CAST(REPLACE(`2019`, &#39;,&#39;, &#39;&#39;) AS DECIMAL(10, 3)) DESC;&#39;&#39;&#39;</span>

<span class="n">inflation2019</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">inflation2019</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="c1">#display(inflation2019)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

The code below focuses on extracting inflation data for the year 2019 from the economic indicators dataset (`economic_indicators`). The resulting data is then loaded into a Pandas DataFrame named `inflation2019_data`.

To enhance consistency, a subsequent step involves updating the country names in the DataFrame using the country_name_mapping dictionary. This standardization ensures uniformity in country names across datasets. The final DataFrame, `inflation2019_data`, stands ready for analysis and exploration, providing a nuanced view of inflation metrics for 2019 across countries. The commented-out display(`inflation2019_data`) can be uncommented for visual inspection of the data.

</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># To extract 2019 Inflation data from economic indicators dataset</span>
<span class="n">inflation2019_data</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    SELECT economic_indicators.Country, </span>
<span class="s1">        economic_indicators.`Subject Descriptor`, </span>
<span class="s1">        economic_indicators.`Subject Notes`, </span>
<span class="s1">        economic_indicators.`2019`, </span>
<span class="s1">        economic_indicators.`Units`, </span>
<span class="s1">        economic_indicators.`Scale`</span>
<span class="s1">    </span>
<span class="s1">    FROM economic_indicators</span>
<span class="s1">    </span>
<span class="s1">    WHERE `Subject Descriptor` = &#39;Inflation, average consumer prices&#39;</span>
<span class="s1">    AND `Subject Notes` = &quot;Expressed in averages for the year, not end-of-period data. A consumer price index (CPI) measures changes in the prices of goods and services that households consume. Such changes affect the real purchasing power of consumers&#39; incomes and their welfare. As the prices of different goods and services do not all change at the same rate, a price index can only reflect their average movement. A price index is typically assigned a value of unity, or 100, in some reference period and the values of the index for other periods of time are intended to indicate the average proportionate, or percentage, change in prices from this price reference period. Price indices can also be used to measure differences in price levels between different cities, regions or countries at the same point in time. [CPI Manual 2004, Introduction] For euro countries, consumer prices are calculated based on harmonized prices. For more information see http://epp.eurostat.ec.europa.eu/cache/ITY_OFFPUB/KS-BE-04-001/EN/KS-BE-04-001-EN.PDF.]&quot;</span>
<span class="s1">    AND `2019` &gt; 0</span>
<span class="s1">    </span>
<span class="s1">    ORDER BY CAST(REPLACE(`2019`, &#39;,&#39;, &#39;&#39;) AS DECIMAL(10, 3)) DESC;&#39;&#39;&#39;</span>

<span class="n">inflation2019_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">inflation2019_data</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="c1"># Update country names</span>
<span class="n">inflation2019_data</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inflation2019_data</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">country_name_mapping</span><span class="p">)</span>

<span class="c1">#display(inflation2019_data)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>We upload this new dataset into the database.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Read to new dataset for 2019 Inflation with updated names to the database</span>
<span class="n">inflation2019_data</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">name</span><span class="o">=</span> <span class="s1">&#39;inflation2019_updated&#39;</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">inflation_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_table</span><span class="p">(</span><span class="s1">&#39;inflation2019_updated&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="n">inflation_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country</th>
      <th>Subject Descriptor</th>
      <th>Subject Notes</th>
      <th>2019</th>
      <th>Units</th>
      <th>Scale</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Brazil</td>
      <td>Inflation, average consumer prices</td>
      <td>Expressed in averages for the year, not end-of...</td>
      <td>34,353,857,264,335.90</td>
      <td>Index</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ukraine</td>
      <td>Inflation, average consumer prices</td>
      <td>Expressed in averages for the year, not end-of...</td>
      <td>87,857,948.11</td>
      <td>Index</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Venezuela (Bolivarian Republic of)</td>
      <td>Inflation, average consumer prices</td>
      <td>Expressed in averages for the year, not end-of...</td>
      <td>3,654,129,639.98</td>
      <td>Index</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Republic of Moldova</td>
      <td>Inflation, average consumer prices</td>
      <td>Expressed in averages for the year, not end-of...</td>
      <td>55,627.85</td>
      <td>Index</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>South Sudan</td>
      <td>Inflation, average consumer prices</td>
      <td>Expressed in averages for the year, not end-of...</td>
      <td>9,456.85</td>
      <td>Index</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Examining the relationship between Inflation Rate and Alcohol Consumption<a rel="noopener" class="anchor-link" href="#Examining-the-relationship-between-Inflation-Rate-and-Alcohol-Consumption">&#182;</a></h4>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

We perform an inner join between the inflation2019_updated dataset, which includes standardized country names, and the alcohol_consumption dataset. 

The aim of this analysis is to identify and explore potential relationships between inflation rates and alcohol consumption patterns across countries. By integrating these datasets, which encapsulate economic indicators and alcohol-related data, the code sets the stage for a comprehensive examination of how changes in consumer prices might correlate with variations in alcohol consumption. The displayed DataFrame provides a visual representation of the combined information, offering insights into the potential interdependencies between economic factors, specifically inflation, and societal behaviors related to alcohol consumption.

</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">inflation1</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;SELECT inflation2019_updated.Country, </span>
<span class="s1">                    inflation2019_updated.`Subject Descriptor`, </span>
<span class="s1">                    inflation2019_updated.`Subject Notes`, </span>
<span class="s1">                    inflation2019_updated.`2019`, </span>
<span class="s1">                    inflation2019_updated.`Units`, </span>
<span class="s1">                    inflation2019_updated.`Scale`,</span>
<span class="s1">                    alcohol_consumption.`Location`, </span>
<span class="s1">                    alcohol_consumption.`Dim1`, </span>
<span class="s1">                    alcohol_consumption.`Period`,</span>
<span class="s1">                    alcohol_consumption.`FactValueNumeric`</span>

<span class="s1">                    FROM inflation2019_updated</span>

<span class="s1">                    INNER JOIN alcohol_consumption ON inflation2019_updated.Country = alcohol_consumption.Location</span>

<span class="s1">                    WHERE `Subject Descriptor` = &#39;Inflation, average consumer prices&#39; </span>
<span class="s1">                    AND `Subject Notes` = &quot;Expressed in averages for the year, not end-of-period data. A consumer price index (CPI) measures changes in the prices of goods and services that households consume. Such changes affect the real purchasing power of consumers&#39; incomes and their welfare. As the prices of different goods and services do not all change at the same rate, a price index can only reflect their average movement. A price index is typically assigned a value of unity, or 100, in some reference period and the values of the index for other periods of time are intended to indicate the average proportionate, or percentage, change in prices from this price reference period. Price indices can also be used to measure differences in price levels between different cities, regions or countries at the same point in time. [CPI Manual 2004, Introduction] For euro countries, consumer prices are calculated based on harmonized prices. For more information see http://epp.eurostat.ec.europa.eu/cache/ITY_OFFPUB/KS-BE-04-001/EN/KS-BE-04-001-EN.PDF.]&quot;</span>
<span class="s1">                    AND `2019` &gt; 0</span>
<span class="s1">                    AND alcohol_consumption.Dim1 = &#39;All Types&#39;</span>
<span class="s1">                    AND alcohol_consumption.Period = &#39;2019&#39;</span>
<span class="s1">                    ORDER BY CAST(REPLACE(`2019`, &#39;,&#39;, &#39;&#39;) AS DECIMAL(10, 3)) DESC;&#39;&#39;&#39;</span>

<span class="n">inflation1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">inflation1</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">inflation1</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country</th>
      <th>Subject Descriptor</th>
      <th>Subject Notes</th>
      <th>2019</th>
      <th>Units</th>
      <th>Scale</th>
      <th>Location</th>
      <th>Dim1</th>
      <th>Period</th>
      <th>FactValueNumeric</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Venezuela (Bolivarian Republic of)</td>
      <td>Inflation, average consumer prices</td>
      <td>Expressed in averages for the year, not end-of...</td>
      <td>3,654,129,639.98</td>
      <td>Index</td>
      <td>None</td>
      <td>Venezuela (Bolivarian Republic of)</td>
      <td>All types</td>
      <td>2019</td>
      <td>2.51</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ukraine</td>
      <td>Inflation, average consumer prices</td>
      <td>Expressed in averages for the year, not end-of...</td>
      <td>87,857,948.11</td>
      <td>Index</td>
      <td>None</td>
      <td>Ukraine</td>
      <td>All types</td>
      <td>2019</td>
      <td>5.69</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Brazil</td>
      <td>Inflation, average consumer prices</td>
      <td>Expressed in averages for the year, not end-of...</td>
      <td>34,353,857,264,335.90</td>
      <td>Index</td>
      <td>None</td>
      <td>Brazil</td>
      <td>All types</td>
      <td>2019</td>
      <td>6.12</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Republic of Moldova</td>
      <td>Inflation, average consumer prices</td>
      <td>Expressed in averages for the year, not end-of...</td>
      <td>55,627.85</td>
      <td>Index</td>
      <td>None</td>
      <td>Republic of Moldova</td>
      <td>All types</td>
      <td>2019</td>
      <td>7.45</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Uzbekistan</td>
      <td>Inflation, average consumer prices</td>
      <td>Expressed in averages for the year, not end-of...</td>
      <td>5,897.81</td>
      <td>Index</td>
      <td>None</td>
      <td>Uzbekistan</td>
      <td>All types</td>
      <td>2019</td>
      <td>2.45</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>172</th>
      <td>Qatar</td>
      <td>Inflation, average consumer prices</td>
      <td>Expressed in averages for the year, not end-of...</td>
      <td>99.3</td>
      <td>Index</td>
      <td>None</td>
      <td>Qatar</td>
      <td>All types</td>
      <td>2019</td>
      <td>0.96</td>
    </tr>
    <tr>
      <th>173</th>
      <td>Brunei Darussalam</td>
      <td>Inflation, average consumer prices</td>
      <td>Expressed in averages for the year, not end-of...</td>
      <td>98.981</td>
      <td>Index</td>
      <td>None</td>
      <td>Brunei Darussalam</td>
      <td>All types</td>
      <td>2019</td>
      <td>0.69</td>
    </tr>
    <tr>
      <th>174</th>
      <td>Costa Rica</td>
      <td>Inflation, average consumer prices</td>
      <td>Expressed in averages for the year, not end-of...</td>
      <td>98.588</td>
      <td>Index</td>
      <td>None</td>
      <td>Costa Rica</td>
      <td>All types</td>
      <td>2019</td>
      <td>3.07</td>
    </tr>
    <tr>
      <th>175</th>
      <td>Saudi Arabia</td>
      <td>Inflation, average consumer prices</td>
      <td>Expressed in averages for the year, not end-of...</td>
      <td>97.917</td>
      <td>Index</td>
      <td>None</td>
      <td>Saudi Arabia</td>
      <td>All types</td>
      <td>2019</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>176</th>
      <td>Dominican Republic</td>
      <td>Inflation, average consumer prices</td>
      <td>Expressed in averages for the year, not end-of...</td>
      <td>97.08</td>
      <td>Index</td>
      <td>None</td>
      <td>Dominican Republic</td>
      <td>All types</td>
      <td>2019</td>
      <td>5.56</td>
    </tr>
  </tbody>
</table>
<p>177 rows &#215; 10 columns</p>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

When we initially visualized the results in a scatterplot, we noticed a few outliers. To gain a better understanding of our dataset, we refine our focus by excluding these outliers from the combined dataset (`inflation2019_updated` and `alcohol_consumption`). Specifically, the countries &#39;Brazil&#39;, &#39;Ukraine&#39;, &#39;Venezuela (Bolivarian Republic of)&#39;, and &#39;Republic of Moldova&#39; are omitted from the dataset to ensure a more focused and representative view. 

This exclusion of outliers enhances the robustness of the dataset, allowing for a more accurate examination of the relationship between inflation rates and alcohol consumption patterns across a more representative set of countries.

</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#To remove outliers which are &#39;Venezuela (Bolivarian Republic of)&#39;,&#39;Brazil&#39; , &#39;Republic of Moldova&#39; pand &#39;Ukraine&#39; for a better view</span>
<span class="n">inflationa</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;SELECT inflation2019_updated.Country, </span>
<span class="s1">                    inflation2019_updated.`Subject Descriptor`, </span>
<span class="s1">                    inflation2019_updated.`Subject Notes`, </span>
<span class="s1">                    inflation2019_updated.`2019`, </span>
<span class="s1">                    inflation2019_updated.`Units`, </span>
<span class="s1">                    inflation2019_updated.`Scale`,</span>
<span class="s1">                    alcohol_consumption.`Location`, </span>
<span class="s1">                    alcohol_consumption.`Dim1`, </span>
<span class="s1">                    alcohol_consumption.`Period`,</span>
<span class="s1">                    alcohol_consumption.`FactValueNumeric`</span>

<span class="s1">                    FROM inflation2019_updated</span>

<span class="s1">                    INNER JOIN alcohol_consumption ON inflation2019_updated.Country = alcohol_consumption.Location</span>

<span class="s1">                    WHERE `Subject Descriptor` = &#39;Inflation, average consumer prices&#39; </span>
<span class="s1">                    AND `Country` NOT IN (&#39;Brazil&#39;, &#39;Ukraine&#39;,&#39;Venezuela (Bolivarian Republic of)&#39;, &#39;Republic of Moldova&#39;)</span>
<span class="s1">                    AND `Subject Notes` = &quot;Expressed in averages for the year, not end-of-period data. A consumer price index (CPI) measures changes in the prices of goods and services that households consume. Such changes affect the real purchasing power of consumers&#39; incomes and their welfare. As the prices of different goods and services do not all change at the same rate, a price index can only reflect their average movement. A price index is typically assigned a value of unity, or 100, in some reference period and the values of the index for other periods of time are intended to indicate the average proportionate, or percentage, change in prices from this price reference period. Price indices can also be used to measure differences in price levels between different cities, regions or countries at the same point in time. [CPI Manual 2004, Introduction] For euro countries, consumer prices are calculated based on harmonized prices. For more information see http://epp.eurostat.ec.europa.eu/cache/ITY_OFFPUB/KS-BE-04-001/EN/KS-BE-04-001-EN.PDF.]&quot;</span>
<span class="s1">                    AND `2019` &gt; 0</span>
<span class="s1">                    AND alcohol_consumption.Dim1 = &#39;All Types&#39;</span>
<span class="s1">                    AND alcohol_consumption.Period = &#39;2019&#39;</span>
<span class="s1">                    ORDER BY CAST(REPLACE(`2019`, &#39;,&#39;, &#39;&#39;) AS DECIMAL(10, 3)) DESC;&#39;&#39;&#39;</span>

<span class="n">inflation2019</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">inflationa</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="c1">#display(inflation2019)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>We visualize this into a scatterplot as well.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">inflation2019</span><span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inflation2019</span><span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

<span class="c1"># Scatter plot for Inflation and Alcohol Consumption</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">inflation2019</span><span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">],</span> <span class="n">inflation2019</span><span class="p">[</span><span class="s1">&#39;FactValueNumeric&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Inflation&#39;</span><span class="p">)</span>

<span class="c1"># Add labels and title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Scatter Plot of Inflation vs. Alcohol Consumption&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Inflation, average consumer prices&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Alcohol Consumption (FactValueNumeric)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Add country labels to each point for Inflation</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">txt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">inflation2019</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="p">(</span><span class="n">inflation2019</span><span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">inflation2019</span><span class="p">[</span><span class="s1">&#39;FactValueNumeric&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

The data points above exhibit a scattered pattern, indicating a lack of discernible correlation between alcohol consumption and inflation rate. Nevertheless, amid the randomness, to gain a clearer understanding, we refine the analysis further by narrowing down the focus to countries with an average consumer price index of less than 500 units. This facilitates a more granular examination of the relationship between inflation rates and alcohol consumption patterns, specifically within countries with moderate consumer price index values.

</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#For a better view, we narrow down to average consumers price of &lt;500 units</span>
<span class="n">inflationb</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;SELECT inflation2019_updated.Country, </span>
<span class="s1">                    inflation2019_updated.`Subject Descriptor`, </span>
<span class="s1">                    inflation2019_updated.`Subject Notes`, </span>
<span class="s1">                    inflation2019_updated.`2019`, </span>
<span class="s1">                    inflation2019_updated.`Units`, </span>
<span class="s1">                    inflation2019_updated.`Scale`,</span>
<span class="s1">                    alcohol_consumption.`Location`, </span>
<span class="s1">                    alcohol_consumption.`Dim1`, </span>
<span class="s1">                    alcohol_consumption.`Period`,</span>
<span class="s1">                    alcohol_consumption.`FactValueNumeric`</span>
<span class="s1">                    FROM inflation2019_updated</span>
<span class="s1">                    INNER JOIN alcohol_consumption ON inflation2019_updated.Country = alcohol_consumption.Location</span>
<span class="s1">                    WHERE `Subject Descriptor` = &#39;Inflation, average consumer prices&#39; </span>
<span class="s1">                    AND `Subject Notes` = &quot;Expressed in averages for the year, not end-of-period data. A consumer price index (CPI) measures changes in the prices of goods and services that households consume. Such changes affect the real purchasing power of consumers&#39; incomes and their welfare. As the prices of different goods and services do not all change at the same rate, a price index can only reflect their average movement. A price index is typically assigned a value of unity, or 100, in some reference period and the values of the index for other periods of time are intended to indicate the average proportionate, or percentage, change in prices from this price reference period. Price indices can also be used to measure differences in price levels between different cities, regions or countries at the same point in time. [CPI Manual 2004, Introduction] For euro countries, consumer prices are calculated based on harmonized prices. For more information see http://epp.eurostat.ec.europa.eu/cache/ITY_OFFPUB/KS-BE-04-001/EN/KS-BE-04-001-EN.PDF.]&quot;</span>
<span class="s1">                    AND `2019` &gt; 0</span>
<span class="s1">                    AND alcohol_consumption.Dim1 = &#39;All Types&#39;</span>
<span class="s1">                    AND alcohol_consumption.Period = &#39;2019&#39;</span>
<span class="s1">                    AND CAST(REPLACE(`2019`, &#39;,&#39;, &#39;&#39;) AS DECIMAL(10, 3)) &lt; 500</span>
<span class="s1">                    ORDER BY CAST(REPLACE(`2019`, &#39;,&#39;, &#39;&#39;) AS DECIMAL(10, 3)) DESC&#39;&#39;&#39;</span><span class="p">;</span>

<span class="n">inflation2019b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">inflationb</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="c1">#display(inflation2019b)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>We also visualize this into a scatterplot</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">inflation2019b</span><span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inflation2019b</span><span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

<span class="c1"># Scatter plot for Inflation and Alcohol Consumption</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">inflation2019b</span><span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">],</span> <span class="n">inflation2019b</span><span class="p">[</span><span class="s1">&#39;FactValueNumeric&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Inflation&#39;</span><span class="p">)</span>

<span class="c1"># Add labels and title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Scatter Plot of Inflation under 500 units vs. Alcohol Consumption&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Inflation, average consumer prices	&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Alcohol Consumption (FactValueNumeric)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Add country labels to each point for Inflation</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">txt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">inflation2019b</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="p">(</span><span class="n">inflation2019b</span><span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">inflation2019b</span><span class="p">[</span><span class="s1">&#39;FactValueNumeric&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

<p>Even after removing the outliers and scaling down to 500 units, the correlation between alcohol consumption and inflation rate remains unclear. The scatterplot, still exhibits a scattered pattern, suggesting the absence of a readily apparent relationship between the two variables.</p>
<p>&lt;/dov&gt;</p>

</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Alcohol Consumption and Unemployment Rates<a rel="noopener" class="anchor-link" href="#Alcohol-Consumption-and-Unemployment-Rates">&#182;</a></h4>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h5>Data Cleaning and Preprocessing<a rel="noopener" class="anchor-link" href="#Data-Cleaning-and-Preprocessing">&#182;</a></h5><p>Below we will clean the data just like we did for GDP and Inflation Rate.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># To find out number of countries in the 2019 unemployment rates data</span>
<span class="n">unemploymentcount</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;SELECT economic_indicators.Country, </span>
<span class="s1">                    economic_indicators.`Subject Descriptor`, </span>
<span class="s1">                    economic_indicators.`Subject Notes`, </span>
<span class="s1">                    economic_indicators.`2019` </span>

<span class="s1">                    FROM economic_indicators</span>
<span class="s1">                    </span>
<span class="s1">                    WHERE `Subject Descriptor` = &#39;Unemployment rate&#39;</span>
<span class="s1">                    AND `2019` &gt; 0</span>
<span class="s1">                    </span>
<span class="s1">                    ORDER BY CAST(REPLACE(`2019`, &#39;,&#39;, &#39;&#39;) AS DECIMAL(10, 3)) DESC&#39;&#39;&#39;</span><span class="p">;</span>

<span class="n">unemploymentcount</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">unemploymentcount</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="n">num_rows</span> <span class="o">=</span> <span class="n">unemploymentcount</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of countries in Unemployment Rate: </span><span class="si">{</span><span class="n">num_rows</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Number of countries in Unemployment Rate: 105
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

We extract data related to the unemployment rate for the year 2019 from the economic indicators dataset (`economic_indicators`). 

To enhance consistency, a subsequent step involves updating the country names in the DataFrame using the `country_name_mapping` dictionary. This standardization ensures uniformity in country names across datasets. The final DataFrame, `unemploy2019_data`, will be used for our analysis, providing insights into the unemployment rates for 2019 across countries. 

</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># To extract 2019 Unemployment data from economic indicators dataset for names update</span>
<span class="n">unemploy2019_data</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    SELECT economic_indicators.Country, </span>
<span class="s1">        economic_indicators.`Subject Descriptor`, </span>
<span class="s1">        economic_indicators.`Subject Notes`, </span>
<span class="s1">        economic_indicators.`2019`, </span>
<span class="s1">        economic_indicators.`Units`, </span>
<span class="s1">        economic_indicators.`Scale`</span>
<span class="s1">    </span>
<span class="s1">    FROM economic_indicators</span>
<span class="s1">    </span>
<span class="s1">    WHERE `Subject Descriptor` = &#39;Unemployment rate&#39;</span>
<span class="s1">    AND `2019` &gt; 0</span>
<span class="s1">    </span>
<span class="s1">    ORDER BY CAST(REPLACE(`2019`, &#39;,&#39;, &#39;&#39;) AS DECIMAL(10, 3)) DESC;&#39;&#39;&#39;</span>

<span class="n">unemploy2019_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">unemploy2019_data</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="c1"># Update country names</span>
<span class="n">unemploy2019_data</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">unemploy2019_data</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">country_name_mapping</span><span class="p">)</span>

<span class="c1">#display(unemploy2019_data)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Read to new dataset for 2019 unemployment rate with updated names to the database</span>
<span class="n">unemploy2019_data</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">name</span><span class="o">=</span> <span class="s1">&#39;uneployment2019_updated&#39;</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">unemploy_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_table</span><span class="p">(</span><span class="s1">&#39;uneployment2019_updated&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="n">unemploy_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country</th>
      <th>Subject Descriptor</th>
      <th>Subject Notes</th>
      <th>2019</th>
      <th>Units</th>
      <th>Scale</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>South Africa</td>
      <td>Unemployment rate</td>
      <td>Unemployment rate can be defined by either the...</td>
      <td>28.7</td>
      <td>Percent of total labor force</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Kosovo</td>
      <td>Unemployment rate</td>
      <td>Unemployment rate can be defined by either the...</td>
      <td>25.7</td>
      <td>Percent of total labor force</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2</th>
      <td>West Bank and Gaza</td>
      <td>Unemployment rate</td>
      <td>Unemployment rate can be defined by either the...</td>
      <td>25.35</td>
      <td>Percent of total labor force</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sudan</td>
      <td>Unemployment rate</td>
      <td>Unemployment rate can be defined by either the...</td>
      <td>22.1</td>
      <td>Percent of total labor force</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Jordan</td>
      <td>Unemployment rate</td>
      <td>Unemployment rate can be defined by either the...</td>
      <td>19.075</td>
      <td>Percent of total labor force</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Examining the relationship between Unemployment Rate and Alcohol Consumption<a rel="noopener" class="anchor-link" href="#Examining-the-relationship-between-Unemployment-Rate-and-Alcohol-Consumption">&#182;</a></h4>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

Likewise, we perform an inner join between the `unemployment2019_updated` dataset, which includes standardized country names, and the `alcohol_consumption` dataset. This analysis aims to identify and explore potential relationships between the unemployment rate and alcohol consumption patterns across countries. 

</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">unemployment</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;SELECT uneployment2019_updated.Country, </span>
<span class="s1">                    uneployment2019_updated.`Subject Descriptor`, </span>
<span class="s1">                    uneployment2019_updated.`Subject Notes`, </span>
<span class="s1">                    uneployment2019_updated.`2019`, </span>
<span class="s1">                    uneployment2019_updated.`Units`, </span>
<span class="s1">                    uneployment2019_updated.`Scale`,</span>
<span class="s1">                    alcohol_consumption.`Location`, </span>
<span class="s1">                    alcohol_consumption.`Dim1`, </span>
<span class="s1">                    alcohol_consumption.`Period`,</span>
<span class="s1">                    alcohol_consumption.`FactValueNumeric`</span>

<span class="s1">                    FROM uneployment2019_updated</span>

<span class="s1">                    INNER JOIN alcohol_consumption ON uneployment2019_updated.Country = alcohol_consumption.Location</span>

<span class="s1">                    WHERE `Subject Descriptor` = &#39;Unemployment rate&#39; </span>
<span class="s1">                    AND `2019` &gt; 0</span>
<span class="s1">                    AND alcohol_consumption.Dim1 = &#39;All Types&#39;</span>
<span class="s1">                    AND alcohol_consumption.Period = &#39;2019&#39;</span>
<span class="s1">                    ORDER BY CAST(REPLACE(`2019`, &#39;,&#39;, &#39;&#39;) AS DECIMAL(10, 3)) DESC;&#39;&#39;&#39;</span>

<span class="n">unemployment2019</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">unemployment</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="c1">#display(unemployment2019)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Visualizing this result into a scatterplot</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">unemployment2019</span><span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">unemployment2019</span><span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

<span class="c1"># Scatter plot for Unemployment and Alcohol Consumption</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">unemployment2019</span><span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">],</span> <span class="n">unemployment2019</span><span class="p">[</span><span class="s1">&#39;FactValueNumeric&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Unemployment&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>

<span class="c1"># Add labels and title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Scatter Plot of Unemployment vs. Alcohol Consumption&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Unemployment rate&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Alcohol Consumption (FactValueNumeric)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Add country labels to each point for Unemployment</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">txt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">unemployment2019</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="p">(</span><span class="n">unemployment2019</span><span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">unemployment2019</span><span class="p">[</span><span class="s1">&#39;FactValueNumeric&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

From the scatterplot, there seems to be no discernible pattern – the points scatter without forming any clear relationship. 

</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

In conclusion, the findings indicate that the connection between a nation&#39;s economic prosperity and alcohol consumption is not a straightforward one. A moderate correlation exists between GDP and alcohol consumption, implying that as a country&#39;s economic output rises, alcohol consumption also tends to increase. On the other hand, there is no apparent correlation when examining inflation and unemployment rates.

</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h2>Guiding Question 2 - Do government restrictions play a factor into a country’s alcohol consumption level?<a rel="noopener" class="anchor-link" href="#Guiding-Question-2---Do-government-restrictions-play-a-factor-into-a-country%E2%80%99s-alcohol-consumption-level?">&#182;</a></h2>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

For the second guiding question, we employed two primary methodologies. The initial approach involved an examination of the distribution of restrictions (bans or no restriction) based on regional data. This preliminary exploration utilized the Public Restrictions dataset, supplemented by information from the World Health Organization (WHO). In our analysis, we utilized the WHO&#39;s classification of six main regions for epidemiological and administrative purposes (n.d.). This initial approach provides insights into which regions exhibit the highest levels of restrictions, enabling us to explore whether these regions also report lower levels of alcohol consumption.

Our second approach includes visualizing the landscape of alcohol consumption across these regions and different types of bans. In our analysis, we focused on three main ban categories (Ban, partial restriction, and no restrictions), as defined by the WHO. To address this aspect, we merged the Alcohol Consumption and Public Restrictions datasets based on the &quot;Country&quot; variable. Since both datasets originate from the WHO, the naming conventions for countries are synonymous, eliminating the need for further data cleaning to align country names.

</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h3>Data Cleaning and Preprocessing<a rel="noopener" class="anchor-link" href="#Data-Cleaning-and-Preprocessing">&#182;</a></h3>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">
Similar to the previous datasets, we first compare the alcohol_consumption and public_restriction datasets to identify countries that are present in one dataset but absent in the other. 
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">public_restriction_discreptancy</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">-- Check Countries that are in alcohol_consumption but not in public_restrictions</span>
<span class="s1">SELECT </span>
<span class="s1">    distinct a.Location AS Country,</span>
<span class="s1">    &#39;alcohol_consumption&#39; AS SourceTable</span>
<span class="s1">FROM</span>
<span class="s1">    alcohol_consumption a</span>
<span class="s1">LEFT JOIN</span>
<span class="s1">    public_restrictions as p</span>
<span class="s1">ON</span>
<span class="s1">    a.Location = p.Location</span>
<span class="s1">WHERE</span>
<span class="s1">    p.Location IS NULL</span>
<span class="s1">UNION</span>
<span class="s1">-- Countries in public_restrictions but not in alcohol_consumption</span>
<span class="s1">SELECT </span>
<span class="s1">    distinct p.Location AS Country,</span>
<span class="s1">    &#39;public_restrictions&#39; AS SourceTable</span>
<span class="s1">FROM</span>
<span class="s1">    alcohol_consumption a</span>
<span class="s1">RIGHT JOIN</span>
<span class="s1">    public_restrictions as p</span>
<span class="s1">ON</span>
<span class="s1">    A.Location = p.Location</span>
<span class="s1">WHERE</span>
<span class="s1">    A.Location IS NULL;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">public_restriction_discreptancy_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">public_restriction_discreptancy</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="n">public_restriction_discreptancy_table</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country</th>
      <th>SourceTable</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Marshall Islands</td>
      <td>public_restrictions</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Monaco</td>
      <td>public_restrictions</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Palau</td>
      <td>public_restrictions</td>
    </tr>
    <tr>
      <th>3</th>
      <td>San Marino</td>
      <td>public_restrictions</td>
    </tr>
    <tr>
      <th>4</th>
      <td>South Sudan</td>
      <td>public_restrictions</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Check for matching country in alcohol_consumption</span>
<span class="n">check_marshall_islands</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT location</span>
<span class="s1">FROM alcohol_consumption</span>
<span class="s1">WHERE location LIKE &#39;%marshall%&#39;;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">check_monaco</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT location</span>
<span class="s1">FROM alcohol_consumption</span>
<span class="s1">WHERE location LIKE &#39;%monaco%&#39;;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">check_palau</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT location</span>
<span class="s1">FROM alcohol_consumption</span>
<span class="s1">WHERE location LIKE &#39;%palau%&#39;;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">check_san_marino</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT location</span>
<span class="s1">FROM alcohol_consumption</span>
<span class="s1">WHERE location LIKE &#39;</span><span class="si">%s</span><span class="s1">an%&#39;;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">check_south_sudan</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT location</span>
<span class="s1">FROM alcohol_consumption</span>
<span class="s1">WHERE location LIKE &#39;</span><span class="si">%s</span><span class="s1">udan%&#39;;</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">check_marshall_islands_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">check_marshall_islands</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="n">check_monaco_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">check_monaco</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="n">check_palau_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">check_palau</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="n">check_san_marino_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">check_san_marino</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
<span class="n">check_south_sudan_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">check_south_sudan</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>

<span class="c1"># check_marshall_islands_table</span>
<span class="c1"># check_monaco_table</span>
<span class="c1"># check_palau_table</span>
<span class="c1"># check_san_marino_table</span>
<span class="c1"># check_south_sudan_table</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Based on our results, the identified countries that require updating are the following:</p>
<ul>
<li><code>Marshall Islands</code></li>
<li><code>Monaco</code></li>
<li><code>Palau</code></li>
<li><code>San Marino</code></li>
<li><code>South Sudan</code></li>
</ul>
<p>However, after further inspection, these countries do not appear to have an existing or matching entry in the alcohol_consumption dataset. Therefore, no more data cleaning is required.</p>

</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Find highest number of restrictions based on &quot;bans&quot;</span>
<span class="n">highest_bans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT ParentLocation, COUNT(DISTINCT Location) AS NumberOfRestrictions</span>
<span class="s1">FROM public_restrictions</span>
<span class="s1">WHERE Value = &#39;Ban&#39;</span>
<span class="s1">GROUP BY ParentLocation</span>
<span class="s1">ORDER BY NumberOfRestrictions DESC;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">highest_bans_query</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">highest_bans</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>

<span class="n">highest_bans_query</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ParentLocation</th>
      <th>NumberOfRestrictions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Europe</td>
      <td>39</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Africa</td>
      <td>36</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Eastern Mediterranean</td>
      <td>16</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Americas</td>
      <td>13</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Western Pacific</td>
      <td>12</td>
    </tr>
    <tr>
      <th>5</th>
      <td>South-East Asia</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Find number of restrictions based on &quot;restriction&quot;</span>
<span class="n">least_bans</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT ParentLocation, COUNT(DISTINCT Location) AS NumberOfRestrictions</span>
<span class="s1">FROM public_restrictions</span>
<span class="s1">WHERE Value = &#39;No restrictions&#39;</span>
<span class="s1">GROUP BY ParentLocation</span>
<span class="s1">ORDER BY NumberOfRestrictions DESC;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">least_bans_query</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">least_bans</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>

<span class="n">least_bans_query</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ParentLocation</th>
      <th>NumberOfRestrictions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Africa</td>
      <td>37</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Europe</td>
      <td>26</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Americas</td>
      <td>16</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Western Pacific</td>
      <td>13</td>
    </tr>
    <tr>
      <th>4</th>
      <td>South-East Asia</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Eastern Mediterranean</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

Based on the results, Europe reports the highest number of bans, while South-East asia reports the least number of bans. In terms of having no restrictions, Africa reports the highest number of no restrictions, with the Eastern Mediterranean reports the lowest number of no restrictions. However, these results may also be due to Africa having more countries compared to other regions or data availability. To mitigate this limitation, we can compare the means of each regions alcohol consumption based on the restriction level.

</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h4>Examining Relationship between Alcohol Consumption and Public Restrictions<a rel="noopener" class="anchor-link" href="#Examining-Relationship-between-Alcohol-Consumption-and-Public-Restrictions">&#182;</a></h4>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Create querytable to join public_restrictions and alcohol_consumption</span>
<span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">SELECT</span>
<span class="s1">    a.Location,</span>
<span class="s1">    a.ParentLocation,</span>
<span class="s1">    a.Dim1 AS alcohol_type,</span>
<span class="s1">    a.FactValueNumeric,</span>
<span class="s1">    a.Period,</span>
<span class="s1">    p.Dim1 AS public_location,</span>
<span class="s1">    p.Value AS Restriction,</span>
<span class="s1">    AVG(a.FactValueNumeric) OVER () AS average_fact_value_numeric</span>
<span class="s1">FROM</span>
<span class="s1">    alcohol_consumption as a</span>
<span class="s1">LEFT JOIN</span>
<span class="s1">    public_restrictions as p ON p.Location = a.Location</span>
<span class="s1">WHERE</span>
<span class="s1">    a.Dim1 = &#39;All types&#39;</span>
<span class="s1">    AND a.Period = &quot;2019&quot;</span>
<span class="s1">    AND p.Value IN (&#39;Ban&#39;, &#39;Partial restriction&#39;, &#39;No restrictions&#39;)</span>
<span class="s1">ORDER BY</span>
<span class="s1">    FactValueNumeric DESC;</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="c1"># Note: Values only include Ban, Partial restriction, and No restrictions</span>

<span class="n">querytable</span> <span class="o">=</span> <span class="n">query1_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">engine</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Assuming &#39;average_fact_value_numeric&#39; and &#39;Restriction&#39; are the column names in your DataFrame</span>
<span class="c1"># Modify these based on your actual column names</span>
<span class="n">numeric_column</span> <span class="o">=</span> <span class="s1">&#39;FactValueNumeric&#39;</span>
<span class="n">restriction_column</span> <span class="o">=</span> <span class="s1">&#39;Restriction&#39;</span>

<span class="c1"># Create a DataFrame for &#39;Ban&#39; and &#39;No Restrictions&#39;</span>
<span class="n">ban_data</span> <span class="o">=</span> <span class="n">querytable</span><span class="p">[</span><span class="n">querytable</span><span class="p">[</span><span class="n">restriction_column</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Ban&#39;</span><span class="p">]</span>
<span class="n">no_restrictions_data</span> <span class="o">=</span> <span class="n">querytable</span><span class="p">[</span><span class="n">querytable</span><span class="p">[</span><span class="n">restriction_column</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;No restrictions&#39;</span><span class="p">]</span>

<span class="c1"># Define a custom color palette</span>
<span class="n">public_restrictions_palette</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Ban&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;Partial restriction&#39;</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;No restrictions&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">}</span>

<span class="c1"># Plot boxplot for &#39;Ban&#39; and &#39;No Restrictions&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">restriction_column</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">numeric_column</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">querytable</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">public_restrictions_palette</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Restriction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Average Fact Value Numeric&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Boxplot of Alcohol Consumption by Restriction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Define column names</span>
<span class="n">parent_location_column</span> <span class="o">=</span> <span class="s1">&#39;ParentLocation&#39;</span>
<span class="n">restriction_column</span> <span class="o">=</span> <span class="s1">&#39;Restriction&#39;</span>
<span class="n">numeric_column</span> <span class="o">=</span> <span class="s1">&#39;FactValueNumeric&#39;</span>

<span class="c1"># Create a DataFrame for &#39;Ban&#39; and &#39;No Restrictions&#39;</span>
<span class="n">ban_data</span> <span class="o">=</span> <span class="n">querytable</span><span class="p">[</span><span class="n">querytable</span><span class="p">[</span><span class="n">restriction_column</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Ban&#39;</span><span class="p">]</span>
<span class="n">no_restrictions_data</span> <span class="o">=</span> <span class="n">querytable</span><span class="p">[</span><span class="n">querytable</span><span class="p">[</span><span class="n">restriction_column</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;No restrictions&#39;</span><span class="p">]</span>

<span class="c1"># Plot boxplots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">parent_location_column</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">numeric_column</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="n">restriction_column</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">querytable</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">public_restrictions_palette</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Parent Location&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Average Fact Value Numeric&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Boxplot of Alcohol Consumption by Region and Restriction Level&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Restriction&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Calculate the mean for each group</span>
<span class="n">means</span> <span class="o">=</span> <span class="n">querytable</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">parent_location_column</span><span class="p">,</span> <span class="n">restriction_column</span><span class="p">])[</span><span class="n">numeric_column</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">means</span> <span class="o">=</span> <span class="n">means</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="n">numeric_column</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Create a bar chart</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">parent_location_column</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">numeric_column</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="n">restriction_column</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">means</span><span class="p">,</span> <span class="n">palette</span> <span class="o">=</span> <span class="n">public_restrictions_palette</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Parent Location&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Average Fact Value Numeric&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Mean Alcohol Consumption by Region and Restriction Level&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Restriction&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>

<span class="c1"># Add annotations directly within the barplot</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">patches</span><span class="p">:</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">height</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">height</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">),</span>
                <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>    

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<div style="text-align: justify;">

When examining global alcohol consumption in relation to restriction levels, areas with a complete ban exhibit the lowest consumption rates compared to those with other restriction levels. Notably, regions with partial restrictions report the highest overall consumption levels. On a global scale, it becomes evident that areas with more stringent government restrictions tend to experience lower levels of alcohol consumption.

Upon further analysis at the regional level, Europe consistently registers the highest overall alcohol consumption across all restriction levels, whereas the Eastern Mediterranean consistently reports the lowest levels. These observations align with anticipated trends: regions imposing stricter government restrictions tend to witness lower average levels of alcohol consumption. This pattern is particularly noticeable in Europe, the Americas, and the Western Pacific. Noteworthy exceptions to these trends are observed in Africa, South-East Asia, and the Eastern Mediterranean regions. However, if we were to ignore partial restrictions from the means table, these regions also follow the expected trend of bans and alcohol consumption. Ultimately, it&#39;s important to note that these results are in the context of public bans of alcohol consumption, and other factors may impact or explain why these trends exist.

</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">engine</span><span class="o">.</span><span class="n">dispose</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1><center> Conclusion </center><a rel="noopener" class="anchor-link" href="#-Conclusion-">&#182;</a></h1><div style="text-align: justify;">

In conclusion, our exploration into the intricate relationship between alcohol consumption and a country&#39;s well-being has provided valuable insights into the nuanced dynamics at play. Analyzing human factors, we observed a moderate correlation between alcohol consumption and happiness, as well as life expectancy, while no clear relationship emerged with suicide rates, indicating the complexity of this interplay. Shifting focus to economic factors, a moderate correlation with GDP suggests a connection between a country&#39;s economic output and alcohol consumption. However, no discernible relationship was found concerning inflation and unemployment rates. A consistent trend underscores the impact of government restrictions, revealing that stringent regulations tend to correlate with lower alcohol consumption across the board. This underscores the necessity of considering both personal and government factors when comprehensively understanding how alcohol influences a country&#39;s well-being.

One crucial lesson our group has gleaned revolves around the significance of maintaining system control while handling multiple datasets. As our project advanced, it became evident that our shared identifier (Country) could have various aliases. Consequently, we recognized the necessity of reaching a consensus on a standardized coding approach. If our group were to approach this differently, we would advocate for standardizing our primary key using country codes (either 3 digits or 2) rather than relying on names. Additionally, we might consider implementing a Python package to streamline and enhance this process.

</div><h2>Limitations<a rel="noopener" class="anchor-link" href="#Limitations">&#182;</a></h2><div style="text-align: justify;">

While our study has yielded insightful findings, it is essential to recognize several limitations that may influence the interpretation of the results. Firstly, the analysis is based on correlation, which establishes associations between variables but does not imply causation. Thus, while we observe correlations between alcohol consumption and certain well-being indicators, the study cannot definitively attribute causative relationships.

Additionally, our exploration relies on the selected indices and datasets, which come with their own set of limitations. The Sustainable Society Index, our guiding framework for assessing well-being, encompasses a broad spectrum of factors but may not capture the entirety of a nation&#39;s complexity. Furthermore, the availability and accuracy of the data sources can vary, impacting the reliability of our conclusions.

A notable limitation involves the selective focus on specific aspects of well-being, potentially neglecting other influential factors. As our study concentrates on human and economic factors, other dimensions such as cultural norms, healthcare systems, and social structures remain unexplored. A more comprehensive analysis would require a holistic examination of these additional variables to provide a fuller picture.

Moreover, it is crucial to acknowledge the omission of certain countries during the inner join process. Some nations lack complete data for the selected factors, leading to their exclusion from the analysis. This omission may introduce bias in the results, as countries with missing data might have unique characteristics that could influence the observed relationships.

In summary, while our study contributes valuable insights, it is imperative to interpret the findings within the context of these limitations. Addressing these constraints in future research endeavors will enhance the robustness and applicability of our understanding of the intricate relationship between alcohol consumption and a country&#39;s well-being.

</div><h2>Future Steps<a rel="noopener" class="anchor-link" href="#Future-Steps">&#182;</a></h2><div style="text-align: justify;">

Looking ahead, future steps involve expanding the scope of our analysis to encompass a broader range of well-being indicators and refining our understanding of the intricate connections identified. Conducting longitudinal studies and incorporating qualitative research methods could provide a more comprehensive understanding of the evolving dynamics between alcohol consumption and a country&#39;s well-being over time. Furthermore, exploring the effectiveness of specific government policies and interventions in influencing alcohol consumption patterns would contribute to more targeted and actionable insights. By addressing these aspects, future research endeavors can contribute to a more nuanced understanding of the complex relationship between alcohol and well-being on a global scale.

</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1><center> References </center><a rel="noopener" class="anchor-link" href="#-References-">&#182;</a></h1><p><p>
International Monetary Fund. (n.d.). <i>World Economic Outlook database</i>. Retrieved November 6, 2023, from https://www.imf.org/en/Publications/WEO/weo-database/2021/April/download-entire-database
</p></p>
<p><p>
Statista. (n.d.). <i>Alcoholic drinks—Worldwide</i>. Retrieved November 6,  2023, from https://www.statista.com/outlook/cmo/alcoholic-drinks/worldwide
</p></p>
<p><p>
Statistics Canada. (2023, February 2). <i>Dry February, you say?</i> https://www.statcan.gc.ca/o1/en/plus/2877-dry-february-you-say
</p></p>
<p><p>
Sustainable Society Index. (n.d.) <i>SSI by TH K&#246;ln</i>. Retrieved November 6, 2023, from https://ssi.wi.th-koeln.de/index.html
</p></p>
<p><p>
<i>World happiness report</i>. (n.d.). Retrieved November 6, 2023, from https://www.kaggle.com/datasets/unsdsn/world-happiness
</p></p>
<p><p>
World Health Organization. (n.d.). <i>Alcohol, recorded per capita (15+) consumption (in litres of pure alcohol)</i>. Retrieved November 6, 2023, from https://www.who.int/data/gho/data/indicators/indicator-details/GHO/alcohol-recorded-per-capita-(15-)-consumption-(in-litres-of-pure-alcohol)
</p></p>
<p><p>
World Health Organization. (n.d.). <i>Life expectancy and Healthy  life expectancy</i>. Retrieved November 6, 2023, from https://apps.who.int/gho/data/node.main.688
</p></p>
<p><p>
World Health Organization. (n.d.). <i>Suicide mortality rate (per 100 000 population)</i>. Retrieved November 6, 2023, from https://data.who.int/indicators/i/
</p></p>
<p><p>
World Health Organization. (n.d.). <i>Use in public places</i>. Retrieved November 6, 2023, from <a rel="noopener" href="https://www.who.int/data/gho/data/themes/topics/indicator-groups/indicator-group-details/GHO/use-in-public-places">https://www.who.int/data/gho/data/themes/topics/indicator-groups/indicator-group-details/GHO/use-in-public-places</a></p>

</p></div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1><center> Appendix A </center><a rel="noopener" class="anchor-link" href="#-Appendix-A-">&#182;</a></h1>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Load the PNG image</span>
<span class="n">image_path</span> <span class="o">=</span> <span class="s1">&#39;ssi_structure.png&#39;</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>

<span class="c1"># Convert from BGR to RGB (matplotlib uses RGB)</span>
<span class="n">img_rgb</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>

<span class="c1"># Display the image</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_rgb</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>  <span class="c1"># Turn off axis labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1><center> Appendix B </center><a rel="noopener" class="anchor-link" href="#-Appendix-B-">&#182;</a></h1>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Load the PNG image</span>
<span class="n">image_path</span> <span class="o">=</span> <span class="s1">&#39;erd_diagram.png&#39;</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>

<span class="c1"># Convert from BGR to RGB (matplotlib uses RGB)</span>
<span class="n">img_rgb</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>

<span class="c1"># Display the image</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_rgb</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>  <span class="c1"># Turn off axis labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div>
</div>








<script type="module" src="https://s.brightspace.com/lib/bsi/20.23.11-218/unbundled/mathjax.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					if (document.querySelector('math') || /\$\$|\\\(|\\\[|\\begin{|\\ref{|\\eqref{/.test(document.body.innerHTML)) {
						document.querySelectorAll('mspace[linebreak="newline"]').forEach(elm => {
							elm.setAttribute('style', 'display: block; height: 0.5rem;');
						});

						window.D2L.MathJax.loadMathJax({
							'outputScale': 1,
							'renderLatex': false
						});
					}
				});</script><script type="module" src="https://s.brightspace.com/lib/bsi/20.23.11-218/unbundled/prism.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					document.querySelectorAll('.d2l-code').forEach(code => {
						window.D2L.Prism.formatCodeElement(code);
					});
				});</script></body></html>